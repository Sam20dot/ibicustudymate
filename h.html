<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ibicu StudyFlow</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        primaryDark: '#4A49B8',
                        secondary: '#F97316',
                        premium: '#FFB700',
                        bgLight: '#FFFFFF',
                        bgDark: '#181818',
                        textLight: '#1F2937',
                        textDark: '#E5E7EB',
                    },
                    animation: {
                        'bounce-slow': 'bounce 3s infinite',
                        'spin-slow': 'spin 2s linear infinite',
                    }
                }
            }
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <style>
        /* Custom styles */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .feature-card {
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .quote-text {
            position: relative;
            font-style: italic;
        }

        .quote-text::before,
        .quote-text::after {
            content: '"';
            font-size: 1.5em;
            color: var(--color-primary);
        }

        /* Progress bar animation */
        @keyframes progress {
            from {
                width: 0%;
            }

            to {
                width: 100%;
            }
        }

        .timer-progress {
            animation: progress linear forwards;
        }

        /* Premium badge */
        .premium-badge {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            box-shadow: 0 2px 5px rgba(255, 183, 0, 0.3);
        }

        .premium-badge-dark {
            background: linear-gradient(135deg, #FFB700, #FF8C00);
            box-shadow: 0 2px 5px rgba(255, 183, 0, 0.5);
        }

        /* Modal animations */
        .modal-backdrop {
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }

        .modal-content {
            transition: all 0.3s ease;
        }

        /* Voice selector custom styles */
        .voice-selector {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }

        /* Dark mode overrides */
        .dark .card {
            background-color: #222;
            border-color: #333;
        }

        .dark .quote-card {
            background-color: #2A2A2A;
        }

        /* Progress bars */
        .progress-bar {
            transition: width 0.5s ease-in-out;
        }

        /* Past paper cards */
        .paper-card {
            transition: all 0.2s ease;
        }

        .paper-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* Toast notifications */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 50;
            animation: slideIn 0.3s, fadeOut 0.5s 2.5s forwards;
        }

        @keyframes slideIn {
            from {
                transform: translateY(100%);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
                visibility: hidden;
            }
        }

        /* Chat message bubbles */
        .chat-bubble-user {
            border-radius: 18px 18px 0 18px;
        }

        .chat-bubble-ai {
            border-radius: 18px 18px 18px 0;
        }

        /* File upload zone */
        .file-drop-zone {
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .file-drop-zone:hover,
        .file-drop-zone.active {
            border-color: #5D5CDE;
            background-color: rgba(93, 92, 222, 0.05);
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .dark ::-webkit-scrollbar-track {
            background: #2d2d2d;
        }

        .dark ::-webkit-scrollbar-thumb {
            background: #4a4a4a;
        }

        .dark ::-webkit-scrollbar-thumb:hover {
            background: #5a5a5a;
        }

        /* Music player */
        .music-player {
            border-radius: 12px;
            overflow: hidden;
        }

        .music-player .controls button {
            transition: all 0.2s ease;
        }

        .music-player .controls button:hover {
            transform: scale(1.1);
        }

        .music-player .progress-bar {
            height: 4px;
            cursor: pointer;
        }

        /* Bible verse card */
        .bible-verse-card {
            background-image: linear-gradient(to right, rgba(93, 92, 222, 0.05), rgba(93, 92, 222, 0.1));
            border-left: 4px solid #5D5CDE;
        }

        .dark .bible-verse-card {
            background-image: linear-gradient(to right, rgba(93, 92, 222, 0.1), rgba(93, 92, 222, 0.15));
        }

        /* Admin Tab Styles */
        .admin-tab-btn.active {
            border-color: #5D5CDE;
            color: #5D5CDE;
        }

        /* Email notification modal */
        .notification-modal {
            z-index: 60;
        }
    </style>
</head>

<body
    class="font-sans antialiased bg-gray-50 dark:bg-bgDark text-textLight dark:text-textDark transition-colors duration-200">
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-white dark:bg-gray-900 shadow-sm sticky top-0 z-10">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-2">
                        <i class="ri-book-mark-line text-primary dark:text-primary text-2xl"></i>
                        <h1 class="text-xl font-bold text-gray-900 dark:text-white">ibicu StudyFlow</h1>
                    </div>
                    <div class="flex items-center space-x-3">
                        <!-- Admin Login Button -->
                        <button id="admin-login-btn"
                            class="px-3 py-1 text-xs rounded-md border border-primary text-primary hover:bg-primary hover:text-white transition duration-150">
                            <i class="ri-shield-user-line mr-1"></i> Admin
                        </button>
                        <!-- Dark Mode Toggle -->
                        <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">
                            <i class="ri-sun-line dark:hidden text-gray-500"></i>
                            <i class="ri-moon-line hidden dark:block text-gray-300"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main content -->
        <main class="flex-grow max-w-7xl w-full mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Tabs Navigation -->
            <div class="flex overflow-x-auto pb-2 mb-4 border-b border-gray-200 dark:border-gray-700">
                <button class="tab-button px-4 py-2 font-medium text-sm mr-4 border-b-2 border-primary text-primary"
                    data-tab="dashboard">Dashboard</button>
                <button
                    class="tab-button px-4 py-2 font-medium text-sm mr-4 border-b-2 border-transparent hover:text-primary hover:border-primary"
                    data-tab="planner">Study Planner</button>
                <button
                    class="tab-button px-4 py-2 font-medium text-sm mr-4 border-b-2 border-transparent hover:text-primary hover:border-primary"
                    data-tab="ai-tutor">AI Tutor</button>
                <button
                    class="tab-button px-4 py-2 font-medium text-sm mr-4 border-b-2 border-transparent hover:text-primary hover:border-primary"
                    data-tab="notes">Notes</button>
                <button
                    class="tab-button px-4 py-2 font-medium text-sm mr-4 border-b-2 border-transparent hover:text-primary hover:border-primary"
                    data-tab="pomodoro">Pomodoro</button>
                <button
                    class="tab-button px-4 py-2 font-medium text-sm mr-4 border-b-2 border-transparent hover:text-primary hover:border-primary"
                    data-tab="motivation">Motivation</button>
                <button
                    class="tab-button px-4 py-2 font-medium text-sm mr-4 border-b-2 border-transparent hover:text-primary hover:border-primary"
                    data-tab="pastpapers">Past Papers</button>
                <button
                    class="tab-button px-4 py-2 font-medium text-sm mr-4 border-b-2 border-transparent hover:text-primary hover:border-primary"
                    data-tab="ibicu-ai">ibicu AI</button>
                <button id="admin-tab-btn"
                    class="tab-button px-4 py-2 font-medium text-sm mr-4 border-b-2 border-transparent hover:text-primary hover:border-primary hidden"
                    data-tab="admin">Admin Portal</button>
            </div>

            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content active">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Welcome Card -->
                    <div
                        class="col-span-1 md:col-span-2 lg:col-span-3 bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700">
                        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4">
                            <div>
                                <h2 class="text-2xl font-bold">Welcome to StudyFlow!</h2>
                                <p id="welcome-message" class="text-gray-600 dark:text-gray-300">Your AI-powered
                                    companion for productive studying and academic success.</p>
                            </div>

                            <!-- Email Notification Sign-up -->
                            <button id="dashboard-notifications-btn"
                                class="mt-3 sm:mt-0 inline-flex items-center px-3 py-2 text-sm font-medium rounded-md text-white bg-primary hover:bg-primaryDark transition duration-150">
                                <i class="ri-notification-3-line mr-1"></i> Enable Reminders
                            </button>
                        </div>

                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                            <div
                                class="feature-card bg-gray-50 dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-primary dark:hover:border-primary">
                                <div class="flex items-center mb-3">
                                    <i class="ri-calendar-check-line text-2xl text-primary mr-2"></i>
                                    <h3 class="font-semibold">Study Planner</h3>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Create AI-generated study schedules
                                    tailored to your needs</p>
                                <button class="tab-link mt-3 text-sm text-primary hover:underline"
                                    data-tab="planner">Open Planner →</button>
                            </div>

                            <div
                                class="feature-card bg-gray-50 dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-primary dark:hover:border-primary">
                                <div class="flex items-center mb-3">
                                    <i class="ri-robot-line text-2xl text-primary mr-2"></i>
                                    <h3 class="font-semibold">AI Tutor</h3>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Get explanations, summaries, and
                                    answers to your questions</p>
                                <button class="tab-link mt-3 text-sm text-primary hover:underline"
                                    data-tab="ai-tutor">Ask AI Tutor →</button>
                            </div>

                            <div
                                class="feature-card bg-gray-50 dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-primary dark:hover:border-primary">
                                <div class="flex items-center mb-3">
                                    <i class="ri-file-text-line text-2xl text-primary mr-2"></i>
                                    <h3 class="font-semibold">Smart Notes</h3>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Take notes, upload files and have
                                    them read aloud with math support</p>
                                <button class="tab-link mt-3 text-sm text-primary hover:underline" data-tab="notes">Take
                                    Notes →</button>
                            </div>

                            <div
                                class="feature-card bg-gray-50 dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-primary dark:hover:border-primary">
                                <div class="flex items-center mb-3">
                                    <i class="ri-timer-line text-2xl text-primary mr-2"></i>
                                    <h3 class="font-semibold">Pomodoro Timer</h3>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Stay focused with timed study
                                    sessions and custom background music</p>
                                <button class="tab-link mt-3 text-sm text-primary hover:underline"
                                    data-tab="pomodoro">Start Timer →</button>
                            </div>

                            <div
                                class="feature-card bg-gray-50 dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-primary dark:hover:border-primary">
                                <div class="flex items-center mb-3">
                                    <i class="ri-sparkling-line text-2xl text-primary mr-2"></i>
                                    <h3 class="font-semibold">Daily Motivation</h3>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Get inspired with quotes, Bible
                                    verses, and productivity challenges</p>
                                <button class="tab-link mt-3 text-sm text-primary hover:underline"
                                    data-tab="motivation">Get Motivated →</button>
                            </div>

                            <div
                                class="feature-card bg-gray-50 dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-primary dark:hover:border-primary">
                                <div class="flex items-center mb-3">
                                    <i class="ri-file-paper-2-line text-2xl text-primary mr-2"></i>
                                    <h3 class="font-semibold">Past Papers</h3>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Access previous exam papers with
                                    marking schemes</p>
                                <button class="tab-link mt-3 text-sm text-primary hover:underline"
                                    data-tab="pastpapers">View Papers →</button>
                            </div>

                            <div
                                class="feature-card bg-gray-50 dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-primary dark:hover:border-primary">
                                <div class="flex items-center mb-3">
                                    <i class="ri-message-3-line text-2xl text-primary mr-2"></i>
                                    <h3 class="font-semibold">ibicu AI</h3>
                                    <span
                                        class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium premium-badge dark:premium-badge-dark text-white">
                                        NEW
                                    </span>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Chat with your personal AI study
                                    assistant</p>
                                <button class="tab-link mt-3 text-sm text-primary hover:underline"
                                    data-tab="ibicu-ai">Open Chat →</button>
                            </div>

                            <div
                                class="feature-card bg-gray-50 dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-primary dark:hover:border-primary">
                                <div class="flex items-center mb-3">
                                    <i class="ri-music-2-line text-2xl text-primary mr-2"></i>
                                    <h3 class="font-semibold">Background Music</h3>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Play your favorite study music while
                                    you work</p>
                                <button id="open-music-player-btn"
                                    class="mt-3 text-sm text-primary hover:underline">Play Music →</button>
                            </div>
                        </div>
                    </div>

                    <!-- Progress Overview -->
                    <div
                        class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-bold text-lg">Today's Tasks</h3>
                            <span
                                class="text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded-full">3
                                remaining</span>
                        </div>
                        <div class="space-y-3">
                            <div class="flex items-center">
                                <input type="checkbox"
                                    class="h-4 w-4 text-primary rounded border-gray-300 dark:border-gray-600 focus:ring-primary"
                                    checked>
                                <span class="ml-2 text-gray-500 dark:text-gray-400 line-through">Review calculus
                                    notes</span>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox"
                                    class="h-4 w-4 text-primary rounded border-gray-300 dark:border-gray-600 focus:ring-primary">
                                <span class="ml-2">Complete biology assignment</span>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox"
                                    class="h-4 w-4 text-primary rounded border-gray-300 dark:border-gray-600 focus:ring-primary">
                                <span class="ml-2">Read chapter 5-7</span>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox"
                                    class="h-4 w-4 text-primary rounded border-gray-300 dark:border-gray-600 focus:ring-primary">
                                <span class="ml-2">Prepare for quiz</span>
                            </div>
                        </div>
                        <button class="mt-4 text-primary text-sm hover:underline flex items-center">
                            <i class="ri-add-line mr-1"></i> Add new task
                        </button>
                    </div>

                    <!-- Upcoming deadlines -->
                    <div
                        class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700">
                        <h3 class="font-bold text-lg mb-4">Upcoming Deadlines</h3>
                        <div class="space-y-4">
                            <div class="border-l-4 border-red-500 pl-3">
                                <p class="font-medium">Physics Lab Report</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Tomorrow, 11:59 PM</p>
                                <div class="mt-1 flex">
                                    <button class="text-xs text-primary hover:underline" id="set-reminder-btn"
                                        data-deadline="Physics Lab Report" data-date="Tomorrow, 11:59 PM">
                                        <i class="ri-alarm-line mr-1"></i> Set Reminder
                                    </button>
                                </div>
                            </div>
                            <div class="border-l-4 border-yellow-500 pl-3">
                                <p class="font-medium">History Essay Draft</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">In 3 days</p>
                                <div class="mt-1 flex">
                                    <button class="text-xs text-primary hover:underline" id="set-reminder-btn"
                                        data-deadline="History Essay Draft" data-date="In 3 days">
                                        <i class="ri-alarm-line mr-1"></i> Set Reminder
                                    </button>
                                </div>
                            </div>
                            <div class="border-l-4 border-green-500 pl-3">
                                <p class="font-medium">Math Midterm Exam</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Next week</p>
                                <div class="mt-1 flex">
                                    <button class="text-xs text-primary hover:underline" id="set-reminder-btn"
                                        data-deadline="Math Midterm Exam" data-date="Next week">
                                        <i class="ri-alarm-line mr-1"></i> Set Reminder
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quote of the day -->
                    <div
                        class="bg-gradient-to-br from-primary/10 to-purple-500/10 dark:from-primary/20 dark:to-purple-500/20 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700 quote-card">
                        <h3 class="font-bold text-lg mb-3">Daily Inspiration</h3>
                        <p class="quote-text text-gray-700 dark:text-gray-200 mb-2" id="quote-text">"The secret of
                            getting ahead is getting started."</p>
                        <p class="text-right text-sm text-gray-500 dark:text-gray-400" id="quote-author">- Mark Twain
                        </p>
                        <button id="new-quote-btn" class="mt-4 text-primary text-sm hover:underline flex items-center">
                            <i class="ri-refresh-line mr-1"></i> New quote
                        </button>
                    </div>
                </div>

                <!-- Enhanced Floating Music Player -->
                <div id="music-player"
                    class="fixed bottom-5 right-5 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-3 w-80 hidden border border-gray-200 dark:border-gray-700 music-player z-30">
                    <div class="flex justify-between items-center mb-3">
                        <h4 class="font-medium">Study Music Player</h4>
                        <button id="close-music-player-btn"
                            class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
                            <i class="ri-close-line"></i>
                        </button>
                    </div>

                    <div class="mb-3 bg-gray-100 dark:bg-gray-700 p-3 rounded-lg">
                        <p class="text-sm text-gray-600 dark:text-gray-300 mb-2">
                            <i class="ri-information-line mr-1 text-blue-500"></i>
                            Paste audio URLs from YouTube, Spotify, or SoundCloud, or choose from the available tracks
                            below.
                        </p>
                    </div>

                    <div class="mb-3">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Add Music
                            URL</label>
                        <div class="flex space-x-2">
                            <input type="text" id="music-url" placeholder="Paste audio URL here"
                                class="flex-grow px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                            <button id="add-music-url-btn"
                                class="px-3 py-1 text-white bg-primary rounded-md hover:bg-primaryDark">
                                <i class="ri-add-line"></i>
                            </button>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Volume</label>
                        <div class="flex items-center">
                            <i class="ri-volume-down-line text-gray-500 mr-2"></i>
                            <input type="range" id="music-volume" min="0" max="100" value="50"
                                class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer">
                            <span id="volume-value"
                                class="ml-2 text-xs text-gray-600 dark:text-gray-400 min-w-[32px] text-center">50%</span>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Available
                            Tracks</label>
                        <div id="music-list"
                            class="space-y-2 max-h-40 overflow-y-auto bg-gray-50 dark:bg-gray-700 p-2 rounded-lg">
                            <div
                                class="p-2 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="ri-music-2-line text-primary text-lg mr-2"></i>
                                    <span class="text-sm">Lo-Fi Study Beats</span>
                                </div>
                                <button
                                    class="music-play-btn p-1.5 rounded-full bg-primary/10 hover:bg-primary/20 text-primary">
                                    <i class="ri-play-fill"></i>
                                </button>
                            </div>
                            <div
                                class="p-2 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="ri-music-2-line text-primary text-lg mr-2"></i>
                                    <span class="text-sm">Classical Piano</span>
                                </div>
                                <button
                                    class="music-play-btn p-1.5 rounded-full bg-primary/10 hover:bg-primary/20 text-primary">
                                    <i class="ri-play-fill"></i>
                                </button>
                            </div>
                            <div
                                class="p-2 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="ri-music-2-line text-primary text-lg mr-2"></i>
                                    <span class="text-sm">Nature Sounds</span>
                                </div>
                                <button
                                    class="music-play-btn p-1.5 rounded-full bg-primary/10 hover:bg-primary/20 text-primary">
                                    <i class="ri-play-fill"></i>
                                </button>
                            </div>
                            <div
                                class="p-2 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="ri-music-2-line text-primary text-lg mr-2"></i>
                                    <span class="text-sm">Lofi Beats</span>
                                </div>
                                <button
                                    class="music-play-btn p-1.5 rounded-full bg-primary/10 hover:bg-primary/20 text-primary">
                                    <i class="ri-play-fill"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="py-2 border-t border-gray-200 dark:border-gray-700">
                        <div class="text-center text-sm text-gray-600 dark:text-gray-400 mb-2">
                            Now Playing: <span id="current-music" class="font-medium">No music selected</span>
                        </div>
                        <div class="flex justify-center space-x-3 controls">
                            <button id="play-music-btn"
                                class="p-2 rounded-full bg-primary text-white hover:bg-primaryDark">
                                <i class="ri-play-fill"></i>
                            </button>
                            <button id="pause-music-btn"
                                class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600">
                                <i class="ri-pause-fill"></i>
                            </button>
                            <button id="stop-music-btn"
                                class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600">
                                <i class="ri-stop-fill"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Study Planner Tab -->
            <div id="planner" class="tab-content">
                <div
                    class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h2 class="text-xl font-bold">Smart Study Planner</h2>
                            <p class="text-gray-600 dark:text-gray-300">Generate a personalized study schedule based on
                                your subjects, deadlines, and study preferences.</p>
                        </div>
                        <div
                            class="rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 px-3 py-1 text-sm flex items-center">
                            <i class="ri-cloud-line mr-1"></i>
                            Powered by Cloud Haiku AI
                        </div>
                    </div>

                    <form id="planner-form" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Your
                                    subjects</label>
                                <textarea id="subjects"
                                    class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                                    rows="3" placeholder="List your subjects (e.g., Math, Physics, History)"></textarea>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Upcoming
                                    deadlines</label>
                                <textarea id="deadlines"
                                    class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                                    rows="3" placeholder="List any deadlines (e.g., Math exam on Friday)"></textarea>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Available
                                    study hours per day</label>
                                <select id="study-hours"
                                    class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                    <option value="1-2">1-2 hours</option>
                                    <option value="3-4" selected>3-4 hours</option>
                                    <option value="5-6">5-6 hours</option>
                                    <option value="7+">7+ hours</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Preferred
                                    study time</label>
                                <select id="study-time"
                                    class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                    <option value="morning">Morning</option>
                                    <option value="afternoon" selected>Afternoon</option>
                                    <option value="evening">Evening</option>
                                    <option value="flexible">Flexible</option>
                                </select>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Additional
                                preferences</label>
                            <textarea id="preferences"
                                class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                                rows="2"
                                placeholder="Any other preferences (e.g., 30 min breaks, focus on difficult subjects first)"></textarea>
                        </div>

                        <div class="flex justify-center">
                            <button id="generate-plan-btn" type="button"
                                class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primaryDark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition duration-150">
                                <i class="ri-calendar-check-line mr-2"></i>
                                Generate Study Plan with Cloud Haiku AI
                            </button>
                        </div>

                        <div class="flex justify-center">
                            <div class="form-check flex items-center">
                                <input id="planner-email-reminder" type="checkbox"
                                    class="h-4 w-4 text-primary rounded border-gray-300 dark:border-gray-600 focus:ring-primary">
                                <label for="planner-email-reminder"
                                    class="ml-2 text-sm text-gray-600 dark:text-gray-400">
                                    Send me email reminders for my study schedule
                                </label>
                            </div>
                        </div>
                    </form>
                </div>

                <div id="study-plan-container"
                    class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700 hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold">Your Personalized Study Plan</h3>
                        <div class="flex space-x-2">
                            <button id="copy-plan-btn"
                                class="text-sm px-3 py-1 border border-primary text-primary rounded-md hover:bg-primary hover:text-white transition duration-150">
                                <i class="ri-file-copy-line mr-1"></i> Copy
                            </button>
                            <button id="save-plan-btn"
                                class="text-sm px-3 py-1 border border-primary text-primary rounded-md hover:bg-primary hover:text-white transition duration-150">
                                <i class="ri-save-line mr-1"></i> Save Plan
                            </button>
                            <button id="email-plan-btn"
                                class="text-sm px-3 py-1 border border-primary text-primary rounded-md hover:bg-primary hover:text-white transition duration-150">
                                <i class="ri-mail-line mr-1"></i> Email Plan
                            </button>
                        </div>
                    </div>

                    <div id="study-plan-content" class="prose dark:prose-invert max-w-none">
                        <!-- AI-generated content will appear here -->
                        <div class="animate-pulse">
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mb-4"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6 mb-2"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-4/5 mb-4"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI Tutor Tab -->
            <div id="ai-tutor" class="tab-content">
                <div
                    class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h2 class="text-xl font-bold">AI Tutor</h2>
                            <p class="text-gray-600 dark:text-gray-300">Get explanations, summaries, and answers to your
                                academic questions.</p>
                        </div>
                        <div
                            class="rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 px-3 py-1 text-sm flex items-center">
                            <i class="ri-cloud-line mr-1"></i>
                            Powered by Cloud Haiku AI
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">What do you need
                            help with?</label>
                        <select id="help-type"
                            class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                            <option value="explanation">Explain a concept</option>
                            <option value="summary">Summarize information</option>
                            <option value="question">Answer a question</option>
                            <option value="example">Provide examples</option>
                            <option value="practice">Generate practice problems</option>
                            <option value="math">Solve a math problem</option>
                        </select>
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Subject
                            area</label>
                        <select id="subject-area"
                            class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                            <option value="math">Mathematics</option>
                            <option value="science">Science</option>
                            <option value="english">English & Literature</option>
                            <option value="history">History & Social Studies</option>
                            <option value="language">Foreign Languages</option>
                            <option value="computer">Computer Science</option>
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Your question or
                            topic</label>
                        <textarea id="ai-question"
                            class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                            rows="4" placeholder="Describe what you need help with in detail..."></textarea>
                    </div>

                    <div class="flex justify-center">
                        <button id="ask-ai-btn" type="button"
                            class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primaryDark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition duration-150">
                            <i class="ri-robot-line mr-2"></i>
                            Ask AI Tutor
                        </button>
                    </div>
                </div>

                <div id="ai-response-container"
                    class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700 hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold">AI Tutor Response</h3>
                        <div>
                            <button id="copy-response-btn"
                                class="text-sm px-3 py-1 border border-primary text-primary rounded-md hover:bg-primary hover:text-white transition duration-150 mr-2">
                                <i class="ri-file-copy-line mr-1"></i> Copy
                            </button>
                            <button id="email-response-btn"
                                class="text-sm px-3 py-1 border border-primary text-primary rounded-md hover:bg-primary hover:text-white transition duration-150 mr-2">
                                <i class="ri-mail-line mr-1"></i> Email
                            </button>
                            <button id="new-question-btn"
                                class="text-sm px-3 py-1 border border-primary text-primary rounded-md hover:bg-primary hover:text-white transition duration-150">
                                <i class="ri-question-line mr-1"></i> New Question
                            </button>
                        </div>
                    </div>

                    <div id="ai-response-content" class="prose dark:prose-invert max-w-none overflow-auto">
                        <!-- AI-generated content will appear here -->
                        <div class="animate-pulse">
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mb-4"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6 mb-2"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-4/5 mb-4"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notes Tab -->
            <div id="notes" class="tab-content">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div
                        class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700">
                        <h2 class="text-xl font-bold mb-4">Smart Notes</h2>
                        <p class="text-gray-600 dark:text-gray-300 mb-6">Take notes, upload files and have them read
                            aloud with mathematics support.</p>

                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Note
                                Title</label>
                            <input type="text" id="note-title"
                                class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                                placeholder="Enter a title for your note">
                        </div>

                        <!-- File Upload Area -->
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Upload Notes
                                (PDF, TXT, DOCX)</label>
                            <div id="file-drop-zone" class="file-drop-zone p-4 text-center">
                                <i class="ri-upload-cloud-line text-3xl text-gray-400 mb-2"></i>
                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">Drag & drop files here or click
                                    to browse</p>
                                <input type="file" id="file-upload" class="hidden" accept=".pdf,.txt,.docx,.md">
                                <button id="browse-files-btn"
                                    class="text-sm px-3 py-1.5 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-200">
                                    Browse Files
                                </button>
                            </div>
                            <div id="upload-progress" class="mt-2 hidden">
                                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1">
                                    <span id="file-name">uploading...</span>
                                    <span id="upload-percentage">0%</span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5">
                                    <div id="upload-progress-bar"
                                        class="bg-primary h-1.5 rounded-full transition-all duration-300"
                                        style="width: 0%"></div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Note
                                Content</label>
                            <div class="flex space-x-2 mb-1">
                                <button id="format-bold" title="Bold"
                                    class="p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">
                                    <i class="ri-bold"></i>
                                </button>
                                <button id="format-italic" title="Italic"
                                    class="p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">
                                    <i class="ri-italic"></i>
                                </button>
                                <button id="format-underline" title="Underline"
                                    class="p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">
                                    <i class="ri-underline"></i>
                                </button>
                                <button id="format-math" title="Insert Math Formula"
                                    class="p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">
                                    <i class="ri-functions"></i>
                                </button>
                            </div>
                            <textarea id="note-content"
                                class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                                rows="12" placeholder="Start typing your notes here...
Use $$ your_formula $$ for math formulas,
e.g., $$ E = mc^2 $$ or $$ \int_0^1 x^2 dx $$"></textarea>
                        </div>

                        <div class="flex flex-wrap gap-2 justify-between items-center">
                            <div class="flex items-center space-x-2">
                                <button id="save-note-btn"
                                    class="inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primaryDark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition duration-150">
                                    <i class="ri-save-line mr-1"></i> Save Note
                                </button>
                                <button id="clear-note-btn"
                                    class="inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-150">
                                    <i class="ri-delete-bin-line mr-1"></i> Clear
                                </button>
                                <button id="preview-math-btn"
                                    class="inline-flex items-center px-3 py-2 border border-primary text-sm font-medium rounded-md shadow-sm text-primary bg-white dark:bg-gray-800 hover:bg-primary hover:text-white dark:hover:bg-primary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition duration-150">
                                    <i class="ri-eye-line mr-1"></i> Preview Math
                                </button>
                                <button id="generate-questions-btn"
                                    class="inline-flex items-center px-3 py-2 border border-primary text-sm font-medium rounded-md shadow-sm text-primary bg-white dark:bg-gray-800 hover:bg-primary hover:text-white dark:hover:bg-primary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition duration-150">
                                    <i class="ri-question-line mr-1"></i> Generate Questions
                                </button>
                            </div>

                            <div class="flex items-center space-x-2">
                                <div
                                    class="flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-3">
                                    <div>
                                        <select id="voice-selector"
                                            class="voice-selector pl-3 pr-8 py-2 text-sm text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                            <!-- Voice options will be populated by JavaScript -->
                                            <option value="default">Default Voice</option>
                                        </select>
                                    </div>
                                    <div class="flex space-x-1">
                                        <button id="read-note-btn"
                                            class="inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150">
                                            <i class="ri-volume-up-line mr-1"></i> Read
                                        </button>
                                        <button id="pause-note-btn"
                                            class="inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-150"
                                            disabled>
                                            <i class="ri-pause-line"></i>
                                        </button>
                                        <button id="stop-note-btn"
                                            class="inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-150"
                                            disabled>
                                            <i class="ri-stop-line"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Voice Settings (collapsible) -->
                        <div id="voice-settings"
                            class="mt-4 pt-4 pb-2 border-t border-gray-200 dark:border-gray-700 hidden">
                            <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Voice Settings</h4>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs text-gray-600 dark:text-gray-400 mb-1">Speech
                                        Rate</label>
                                    <div class="flex items-center">
                                        <input type="range" id="speech-rate" min="0.5" max="2" step="0.1" value="1"
                                            class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                        <span id="speech-rate-value" class="ml-2 text-xs">1.0</span>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-600 dark:text-gray-400 mb-1">Pitch</label>
                                    <div class="flex items-center">
                                        <input type="range" id="speech-pitch" min="0.5" max="2" step="0.1" value="1"
                                            class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                        <span id="speech-pitch-value" class="ml-2 text-xs">1.0</span>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-3">
                                <label class="block text-xs text-gray-600 dark:text-gray-400 mb-1">Math Reading
                                    Settings</label>
                                <select id="math-reading-mode"
                                    class="w-full px-3 py-2 text-sm text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                    <option value="skip">Skip math formulas</option>
                                    <option value="simple" selected>Read math formulas simply</option>
                                    <option value="detailed">Read math formulas in detail</option>
                                </select>
                            </div>
                            <button id="toggle-voice-settings"
                                class="mt-3 text-xs text-primary hover:underline flex items-center">
                                <i class="ri-arrow-up-s-line mr-1"></i> Hide Settings
                            </button>
                        </div>
                        <button id="toggle-voice-settings-closed"
                            class="mt-2 text-xs text-primary hover:underline flex items-center">
                            <i class="ri-settings-3-line mr-1"></i> Voice Settings
                        </button>
                    </div>

                    <div
                        class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700">
                        <h3 class="text-lg font-bold mb-4">Your Notes</h3>

                        <div class="mb-3">
                            <input type="text" id="note-search"
                                class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                                placeholder="Search notes...">
                        </div>

                        <div id="notes-list" class="space-y-3 max-h-96 overflow-y-auto">
                            <div
                                class="p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer">
                                <div class="flex justify-between">
                                    <p class="font-medium">Biology Chapter 5</p>
                                    <span
                                        class="text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300 px-1.5 py-0.5 rounded">Text</span>
                                </div>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Yesterday, 3:42 PM</p>
                            </div>
                            <div
                                class="p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer">
                                <div class="flex justify-between">
                                    <p class="font-medium">History Lecture Notes</p>
                                    <span
                                        class="text-xs bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300 px-1.5 py-0.5 rounded">PDF</span>
                                </div>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Oct 12, 2023</p>
                            </div>
                            <div
                                class="p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer">
                                <div class="flex justify-between">
                                    <p class="font-medium">Math Formulas</p>
                                    <span
                                        class="text-xs bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300 px-1.5 py-0.5 rounded">Math</span>
                                </div>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Oct 5, 2023</p>
                            </div>
                        </div>

                        <!-- Preview Panel -->
                        <div id="math-preview-panel"
                            class="mt-4 pt-4 pb-2 border-t border-gray-200 dark:border-gray-700 hidden">
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300">Math Preview</h4>
                                <button id="close-preview"
                                    class="text-xs text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
                                    <i class="ri-close-line"></i>
                                </button>
                            </div>
                            <div id="math-preview-content"
                                class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg overflow-auto max-h-60">
                                <!-- Math preview will be rendered here -->
                            </div>
                        </div>

                        <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                            <h4 class="font-medium mb-2">Export Options</h4>
                            <div class="flex space-x-2">
                                <button id="export-txt-btn"
                                    class="inline-flex items-center px-3 py-1.5 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-150">
                                    <i class="ri-file-text-line mr-1"></i> Text
                                </button>
                                <button id="export-pdf-btn"
                                    class="inline-flex items-center px-3 py-1.5 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-150">
                                    <i class="ri-file-pdf-line mr-1"></i> PDF
                                </button>
                                <button id="export-md-btn"
                                    class="inline-flex items-center px-3 py-1.5 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-150">
                                    <i class="ri-markdown-line mr-1"></i> Markdown
                                </button>
                            </div>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">Right-click to save generated
                                content</p>
                        </div>
                    </div>
                </div>

                <!-- Generated Questions Modal (Hidden by default) -->
                <div id="questions-modal" class="fixed inset-0 z-50 overflow-y-auto hidden">
                    <div
                        class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
                        <div class="fixed inset-0 transition-opacity modal-backdrop" aria-hidden="true">
                            <div class="absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"></div>
                        </div>

                        <span class="hidden sm:inline-block sm:align-middle sm:h-screen"
                            aria-hidden="true">&#8203;</span>

                        <div
                            class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full modal-content">
                            <div class="px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                                <div class="sm:flex sm:items-start">
                                    <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                                        <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white mb-4">
                                            Generated Study Questions
                                        </h3>
                                        <div id="questions-container" class="mt-2 space-y-4">
                                            <!-- Questions will be loaded here -->
                                            <div class="animate-pulse">
                                                <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"></div>
                                                <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6 mb-4"></div>
                                                <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"></div>
                                                <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mb-4"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                                <button id="save-questions-btn" type="button"
                                    class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary text-base font-medium text-white hover:bg-primaryDark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary sm:ml-3 sm:w-auto sm:text-sm">
                                    Save Questions
                                </button>
                                <button id="close-questions-modal-btn" type="button"
                                    class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-800 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                                    Close
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pomodoro Tab -->
            <div id="pomodoro" class="tab-content">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div
                        class="md:col-span-2 bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700">
                        <h2 class="text-xl font-bold mb-4">Pomodoro Timer</h2>
                        <p class="text-gray-600 dark:text-gray-300 mb-6">Stay focused with timed study sessions and
                            short breaks.</p>

                        <div class="flex flex-col items-center">
                            <div class="relative w-64 h-64 mb-8">
                                <div
                                    class="absolute inset-0 rounded-full border-8 border-gray-200 dark:border-gray-700">
                                </div>
                                <div id="timer-progress" class="absolute inset-0 rounded-full border-8 border-primary"
                                    style="clip: rect(0px, 150px, 300px, 0px);"></div>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <div class="text-center">
                                        <div id="timer-display" class="text-5xl font-bold">25:00</div>
                                        <div id="timer-label" class="text-gray-500 dark:text-gray-400">Focus Time</div>
                                    </div>
                                </div>
                            </div>

                            <div class="flex space-x-4 mb-8">
                                <button id="timer-start"
                                    class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primaryDark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition duration-150">
                                    <i class="ri-play-line mr-1"></i> Start
                                </button>
                                <button id="timer-pause"
                                    class="inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-base font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-150"
                                    disabled>
                                    <i class="ri-pause-line mr-1"></i> Pause
                                </button>
                                <button id="timer-reset"
                                    class="inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-base font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-150"
                                    disabled>
                                    <i class="ri-refresh-line mr-1"></i> Reset
                                </button>
                            </div>

                            <div class="grid grid-cols-2 gap-4 w-full max-w-md">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Focus
                                        Time (min)</label>
                                    <select id="focus-duration"
                                        class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                        <option value="15">15 minutes</option>
                                        <option value="25" selected>25 minutes</option>
                                        <option value="30">30 minutes</option>
                                        <option value="45">45 minutes</option>
                                        <option value="60">60 minutes</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Break
                                        Time (min)</label>
                                    <select id="break-duration"
                                        class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                        <option value="5" selected>5 minutes</option>
                                        <option value="10">10 minutes</option>
                                        <option value="15">15 minutes</option>
                                        <option value="20">20 minutes</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-check flex items-center mt-4">
                                <input id="timer-email-reminder" type="checkbox"
                                    class="h-4 w-4 text-primary rounded border-gray-300 dark:border-gray-600 focus:ring-primary">
                                <label for="timer-email-reminder" class="ml-2 text-sm text-gray-600 dark:text-gray-400">
                                    Send me email reminders for completed sessions
                                </label>
                            </div>
                        </div>
                    </div>

                    <div
                        class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700">
                        <h3 class="font-bold text-lg mb-4">Custom Background Music</h3>
                        <p class="text-gray-600 dark:text-gray-300 mb-4">Play your favorite music to enhance focus.</p>

                        <div
                            class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-900 rounded-lg p-3 mb-4">
                            <p class="text-sm text-blue-800 dark:text-blue-200">
                                <i class="ri-information-line mr-1"></i>
                                For best results, use direct audio URLs or select from our curated study tracks.
                            </p>
                        </div>

                        <div class="space-y-3">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Add Music
                                    URL</label>
                                <div class="flex space-x-2">
                                    <input type="text" id="music-url-input"
                                        placeholder="YouTube, Spotify or SoundCloud URL"
                                        class="flex-grow px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                    <button id="add-music-btn"
                                        class="px-3 py-1 text-white bg-primary rounded-md hover:bg-primaryDark">
                                        <i class="ri-add-line"></i>
                                    </button>
                                </div>
                            </div>

                            <div id="music-list" class="space-y-3 max-h-40 overflow-y-auto">
                                <div
                                    class="p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <i class="ri-volume-up-line text-primary text-xl mr-2"></i>
                                            <span>Ambient Nature</span>
                                        </div>
                                        <button
                                            class="music-play-btn p-2 rounded-full bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500">
                                            <i class="ri-play-line"></i>
                                        </button>
                                    </div>
                                </div>

                                <div
                                    class="p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <i class="ri-volume-up-line text-primary text-xl mr-2"></i>
                                            <span>Soft Piano</span>
                                        </div>
                                        <button
                                            class="music-play-btn p-2 rounded-full bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500">
                                            <i class="ri-play-line"></i>
                                        </button>
                                    </div>
                                </div>

                                <div
                                    class="p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <i class="ri-volume-up-line text-primary text-xl mr-2"></i>
                                            <span>White Noise</span>
                                        </div>
                                        <button
                                            class="music-play-btn p-2 rounded-full bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500">
                                            <i class="ri-play-line"></i>
                                        </button>
                                    </div>
                                </div>

                                <div
                                    class="p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <i class="ri-volume-up-line text-primary text-xl mr-2"></i>
                                            <span>Lofi Beats</span>
                                        </div>
                                        <button
                                            class="music-play-btn p-2 rounded-full bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500">
                                            <i class="ri-play-line"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mt-6">
                            <h4 class="font-medium mb-2">Session Statistics</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600 dark:text-gray-400">Today's focus time:</span>
                                    <span class="font-medium">1h 45m</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600 dark:text-gray-400">Completed sessions:</span>
                                    <span class="font-medium">4</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-gray-600 dark:text-gray-400">Weekly average:</span>
                                    <span class="font-medium">2h 30m</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Motivation Tab -->
            <div id="motivation" class="tab-content">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div
                        class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700">
                        <h2 class="text-xl font-bold mb-4">Daily Motivation</h2>
                        <p class="text-gray-600 dark:text-gray-300 mb-6">Get inspired with quotes and success stories to
                            keep you motivated.</p>

                        <div id="motivation-quote-card"
                            class="bg-gradient-to-br from-primary/10 to-purple-500/10 dark:from-primary/20 dark:to-purple-500/20 rounded-xl p-6 mb-6">
                            <h3 class="font-bold text-lg mb-3">Quote of the Day</h3>
                            <p class="quote-text text-gray-700 dark:text-gray-200 mb-2">"The only way to do great work
                                is to love what you do. If you haven't found it yet, keep looking. Don't settle."</p>
                            <p class="text-right text-sm text-gray-500 dark:text-gray-400">- Steve Jobs</p>
                        </div>

                        <!-- Bible Verse Card (NEW) -->
                        <div class="bible-verse-card rounded-lg p-6 mb-6">
                            <h3 class="font-bold text-lg mb-3">Bible Verse</h3>
                            <p id="bible-verse-text" class="text-gray-700 dark:text-gray-200 mb-2">"For I know the plans
                                I have for you," declares the LORD, "plans to prosper you and not to harm you, plans to
                                give you hope and a future."</p>
                            <p id="bible-verse-reference" class="text-right text-sm text-gray-500 dark:text-gray-400">-
                                Jeremiah 29:11</p>
                            <button id="new-verse-btn"
                                class="mt-3 text-primary text-sm hover:underline flex items-center">
                                <i class="ri-refresh-line mr-1"></i> New verse
                            </button>
                        </div>

                        <div class="mb-6">
                            <h3 class="font-bold text-lg mb-3">Success Story</h3>
                            <div class="p-4 border border-gray-200 dark:border-gray-700 rounded-lg">
                                <h4 class="font-medium text-primary mb-2">From Struggle to Success</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-300 mb-3">
                                    "I failed my first semester in college and almost gave up. But I created a strict
                                    study schedule, joined study groups, and used online resources to understand
                                    difficult concepts. Now I'm graduating with honors and have already secured a job in
                                    my field."
                                </p>
                                <p class="text-right text-xs text-gray-500 dark:text-gray-400">- Alex, Computer Science
                                    Student</p>
                            </div>
                        </div>

                        <div>
                            <h3 class="font-bold text-lg mb-3">Quick Motivation</h3>
                            <button id="motivate-me-btn"
                                class="w-full inline-flex justify-center items-center px-4 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primaryDark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition duration-150">
                                <i class="ri-heart-3-line mr-2"></i> Motivate Me
                            </button>
                        </div>
                    </div>

                    <div
                        class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700">
                        <h2 class="text-xl font-bold mb-4">Productivity Challenges</h2>
                        <p class="text-gray-600 dark:text-gray-300 mb-6">Take on challenges to boost your productivity
                            and study habits.</p>

                        <div class="space-y-4">
                            <div
                                class="p-4 border border-green-200 dark:border-green-900 bg-green-50 dark:bg-green-900/20 rounded-lg">
                                <div class="flex items-start">
                                    <div class="flex-shrink-0 mt-0.5">
                                        <i
                                            class="ri-checkbox-circle-line text-green-600 dark:text-green-400 text-xl"></i>
                                    </div>
                                    <div class="ml-3">
                                        <h3 class="text-base font-medium text-green-800 dark:text-green-300">5-Day Focus
                                            Challenge</h3>
                                        <p class="mt-1 text-sm text-green-700 dark:text-green-400">Complete 4 focused
                                            study sessions each day for 5 consecutive days.</p>
                                        <div class="mt-2 flex items-center">
                                            <span
                                                class="text-xs text-green-600 dark:text-green-400 font-medium">Progress:
                                                100%</span>
                                            <div class="ml-2 w-full bg-green-200 dark:bg-green-800 rounded-full h-1.5">
                                                <div class="bg-green-600 dark:bg-green-400 h-1.5 rounded-full"
                                                    style="width: 100%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div
                                class="p-4 border border-blue-200 dark:border-blue-900 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                <div class="flex items-start">
                                    <div class="flex-shrink-0 mt-0.5">
                                        <i class="ri-time-line text-blue-600 dark:text-blue-400 text-xl"></i>
                                    </div>
                                    <div class="ml-3">
                                        <h3 class="text-base font-medium text-blue-800 dark:text-blue-300">
                                            No-Distraction Week</h3>
                                        <p class="mt-1 text-sm text-blue-700 dark:text-blue-400">Study without checking
                                            social media or unrelated websites.</p>
                                        <div class="mt-2 flex items-center">
                                            <span class="text-xs text-blue-600 dark:text-blue-400 font-medium">Progress:
                                                60%</span>
                                            <div class="ml-2 w-full bg-blue-200 dark:bg-blue-800 rounded-full h-1.5">
                                                <div class="bg-blue-600 dark:bg-blue-400 h-1.5 rounded-full"
                                                    style="width: 60%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div
                                class="p-4 border border-purple-200 dark:border-purple-900 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
                                <div class="flex items-start">
                                    <div class="flex-shrink-0 mt-0.5">
                                        <i class="ri-book-open-line text-purple-600 dark:text-purple-400 text-xl"></i>
                                    </div>
                                    <div class="ml-3">
                                        <h3 class="text-base font-medium text-purple-800 dark:text-purple-300">30-Day
                                            Reading Challenge</h3>
                                        <p class="mt-1 text-sm text-purple-700 dark:text-purple-400">Read at least 20
                                            pages every day for a month.</p>
                                        <div class="mt-2 flex items-center">
                                            <span
                                                class="text-xs text-purple-600 dark:text-purple-400 font-medium">Progress:
                                                23%</span>
                                            <div
                                                class="ml-2 w-full bg-purple-200 dark:bg-purple-800 rounded-full h-1.5">
                                                <div class="bg-purple-600 dark:bg-purple-400 h-1.5 rounded-full"
                                                    style="width: 23%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Scripture Memory Challenge (NEW) -->
                            <div
                                class="p-4 border border-amber-200 dark:border-amber-900 bg-amber-50 dark:bg-amber-900/20 rounded-lg">
                                <div class="flex items-start">
                                    <div class="flex-shrink-0 mt-0.5">
                                        <i class="ri-book-mark-line text-amber-600 dark:text-amber-400 text-xl"></i>
                                    </div>
                                    <div class="ml-3">
                                        <h3 class="text-base font-medium text-amber-800 dark:text-amber-300">Scripture
                                            Memory Challenge</h3>
                                        <p class="mt-1 text-sm text-amber-700 dark:text-amber-400">Memorize one Bible
                                            verse each week.</p>
                                        <div class="mt-2 flex items-center">
                                            <span
                                                class="text-xs text-amber-600 dark:text-amber-400 font-medium">Progress:
                                                40%</span>
                                            <div class="ml-2 w-full bg-amber-200 dark:bg-amber-800 rounded-full h-1.5">
                                                <div class="bg-amber-600 dark:bg-amber-400 h-1.5 rounded-full"
                                                    style="width: 40%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <button id="new-challenge-btn"
                                class="mt-2 w-full inline-flex justify-center items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-150">
                                <i class="ri-add-line mr-1"></i> Start New Challenge
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Past Papers Tab -->
            <div id="pastpapers" class="tab-content">
                <div
                    class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700 mb-6">
                    <div class="flex flex-wrap items-center justify-between mb-6">
                        <div>
                            <h2 class="text-xl font-bold">Past Exam Papers</h2>
                            <p class="text-gray-600 dark:text-gray-300">Access previous exam papers to practice and
                                prepare for upcoming exams.</p>
                        </div>
                        <div class="mt-4 sm:mt-0">
                            <button
                                class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primaryDark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition duration-150">
                                <i class="ri-filter-3-line mr-1"></i> Filter Papers
                            </button>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div>
                            <label
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Subject</label>
                            <select id="paper-subject"
                                class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                <option value="all">All Subjects</option>
                                <option value="math">Mathematics</option>
                                <option value="physics">Physics</option>
                                <option value="chemistry">Chemistry</option>
                                <option value="biology">Biology</option>
                                <option value="english">English</option>
                                <option value="history">History</option>
                                <option value="geography">Geography</option>
                                <option value="cs">Computer Science</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Exam
                                Level</label>
                            <select id="paper-level"
                                class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                <option value="all">All Levels</option>
                                <option value="highschool">High School</option>
                                <option value="gcse">GCSE</option>
                                <option value="alevel">A-Level</option>
                                <option value="university">University</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Year</label>
                            <select id="paper-year"
                                class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                <option value="all">All Years</option>
                                <option value="2023">2023</option>
                                <option value="2022">2022</option>
                                <option value="2021">2021</option>
                                <option value="2020">2020</option>
                                <option value="2019">2019</option>
                                <option value="2018">2018</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Exam
                                Board</label>
                            <select id="paper-board"
                                class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                <option value="all">All Boards</option>
                                <option value="aqa">AQA</option>
                                <option value="edexcel">Edexcel</option>
                                <option value="ocr">OCR</option>
                                <option value="wjec">WJEC</option>
                                <option value="cambridge">Cambridge</option>
                                <option value="ib">IB</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Sample past papers -->
                        <div
                            class="paper-card bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden">
                            <div class="p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="font-medium text-gray-900 dark:text-white">Mathematics Paper 1</h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">A-Level - Edexcel (2022)</p>
                                    </div>
                                    <span
                                        class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-blue-900 dark:text-blue-300">Pure
                                        Math</span>
                                </div>
                                <div class="mt-3 flex items-center text-sm text-gray-500 dark:text-gray-400">
                                    <i class="ri-time-line mr-1"></i> 2 hours
                                    <span class="mx-2">•</span>
                                    <i class="ri-file-list-line mr-1"></i> 100 marks
                                </div>
                                <div class="mt-4 flex items-center justify-between">
                                    <button
                                        class="text-primary hover:text-primaryDark hover:underline text-sm font-medium">
                                        View Paper
                                    </button>
                                    <div class="flex space-x-2">
                                        <button
                                            class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white">
                                            <i class="ri-bookmark-line"></i>
                                        </button>
                                        <button
                                            class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white">
                                            <i class="ri-download-line"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 px-4 py-2 flex justify-between">
                                <span class="text-xs text-gray-500 dark:text-gray-400">
                                    <i class="ri-check-line mr-1 text-green-500"></i> Mark Scheme Available
                                </span>
                                <span class="text-xs text-gray-500 dark:text-gray-400">
                                    <i class="ri-eye-line mr-1"></i> 2.5k views
                                </span>
                            </div>
                        </div>

                        <div
                            class="paper-card bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden">
                            <div class="p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="font-medium text-gray-900 dark:text-white">Physics Paper 2</h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">A-Level - AQA (2022)</p>
                                    </div>
                                    <span
                                        class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-purple-900 dark:text-purple-300">Advanced</span>
                                </div>
                                <div class="mt-3 flex items-center text-sm text-gray-500 dark:text-gray-400">
                                    <i class="ri-time-line mr-1"></i> 2 hours
                                    <span class="mx-2">•</span>
                                    <i class="ri-file-list-line mr-1"></i> 85 marks
                                </div>
                                <div class="mt-4 flex items-center justify-between">
                                    <button
                                        class="text-primary hover:text-primaryDark hover:underline text-sm font-medium">
                                        View Paper
                                    </button>
                                    <div class="flex space-x-2">
                                        <button
                                            class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white">
                                            <i class="ri-bookmark-line"></i>
                                        </button>
                                        <button
                                            class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white">
                                            <i class="ri-download-line"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 px-4 py-2 flex justify-between">
                                <span class="text-xs text-gray-500 dark:text-gray-400">
                                    <i class="ri-check-line mr-1 text-green-500"></i> Mark Scheme Available
                                </span>
                                <span class="text-xs text-gray-500 dark:text-gray-400">
                                    <i class="ri-eye-line mr-1"></i> 1.8k views
                                </span>
                            </div>
                        </div>

                        <div
                            class="paper-card bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden">
                            <div class="p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="font-medium text-gray-900 dark:text-white">Biology Paper 1</h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">GCSE - OCR (2021)</p>
                                    </div>
                                    <span
                                        class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-green-900 dark:text-green-300">Foundation</span>
                                </div>
                                <div class="mt-3 flex items-center text-sm text-gray-500 dark:text-gray-400">
                                    <i class="ri-time-line mr-1"></i> 1 hour 45 min
                                    <span class="mx-2">•</span>
                                    <i class="ri-file-list-line mr-1"></i> 90 marks
                                </div>
                                <div class="mt-4 flex items-center justify-between">
                                    <button
                                        class="text-primary hover:text-primaryDark hover:underline text-sm font-medium">
                                        View Paper
                                    </button>
                                    <div class="flex space-x-2">
                                        <button
                                            class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white">
                                            <i class="ri-bookmark-line"></i>
                                        </button>
                                        <button
                                            class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white">
                                            <i class="ri-download-line"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 px-4 py-2 flex justify-between">
                                <span class="text-xs text-gray-500 dark:text-gray-400">
                                    <i class="ri-check-line mr-1 text-green-500"></i> Mark Scheme Available
                                </span>
                                <span class="text-xs text-gray-500 dark:text-gray-400">
                                    <i class="ri-eye-line mr-1"></i> 3.2k views
                                </span>
                            </div>
                        </div>

                        <div
                            class="paper-card bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden">
                            <div class="p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="font-medium text-gray-900 dark:text-white">Computer Science Paper 2
                                        </h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">A-Level - AQA (2022)</p>
                                    </div>
                                    <span
                                        class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-blue-900 dark:text-blue-300">Programming</span>
                                </div>
                                <div class="mt-3 flex items-center text-sm text-gray-500 dark:text-gray-400">
                                    <i class="ri-time-line mr-1"></i> 2 hours 30 min
                                    <span class="mx-2">•</span>
                                    <i class="ri-file-list-line mr-1"></i> 90 marks
                                </div>
                                <div class="mt-4 flex items-center justify-between">
                                    <button
                                        class="text-primary hover:text-primaryDark hover:underline text-sm font-medium">
                                        View Paper
                                    </button>
                                    <div class="flex space-x-2">
                                        <button
                                            class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white">
                                            <i class="ri-bookmark-line"></i>
                                        </button>
                                        <button
                                            class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white">
                                            <i class="ri-download-line"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 px-4 py-2 flex justify-between">
                                <span class="text-xs text-gray-500 dark:text-gray-400">
                                    <i class="ri-check-line mr-1 text-green-500"></i> Mark Scheme Available
                                </span>
                                <span class="text-xs text-gray-500 dark:text-gray-400">
                                    <i class="ri-eye-line mr-1"></i> 1.4k views
                                </span>
                            </div>
                        </div>

                        <div
                            class="paper-card bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden">
                            <div class="p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="font-medium text-gray-900 dark:text-white">Chemistry Paper 1</h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">GCSE - Edexcel (2022)</p>
                                    </div>
                                    <span
                                        class="bg-orange-100 text-orange-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-orange-900 dark:text-orange-300">Higher</span>
                                </div>
                                <div class="mt-3 flex items-center text-sm text-gray-500 dark:text-gray-400">
                                    <i class="ri-time-line mr-1"></i> 1 hour 45 min
                                    <span class="mx-2">•</span>
                                    <i class="ri-file-list-line mr-1"></i> 100 marks
                                </div>
                                <div class="mt-4 flex items-center justify-between">
                                    <button
                                        class="text-primary hover:text-primaryDark hover:underline text-sm font-medium">
                                        View Paper
                                    </button>
                                    <div class="flex space-x-2">
                                        <button
                                            class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white">
                                            <i class="ri-bookmark-line"></i>
                                        </button>
                                        <button
                                            class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white">
                                            <i class="ri-download-line"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 px-4 py-2 flex justify-between">
                                <span class="text-xs text-gray-500 dark:text-gray-400">
                                    <i class="ri-check-line mr-1 text-green-500"></i> Mark Scheme Available
                                </span>
                                <span class="text-xs text-gray-500 dark:text-gray-400">
                                    <i class="ri-eye-line mr-1"></i> 2.1k views
                                </span>
                            </div>
                        </div>

                        <div
                            class="paper-card bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden">
                            <div class="p-4">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="font-medium text-gray-900 dark:text-white">English Literature Paper 2
                                        </h3>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">A-Level - OCR (2021)</p>
                                    </div>
                                    <span
                                        class="premium-badge dark:premium-badge-dark text-xs font-medium px-2.5 py-0.5 rounded text-white">
                                        NEW
                                    </span>
                                </div>
                                <div class="mt-3 flex items-center text-sm text-gray-500 dark:text-gray-400">
                                    <i class="ri-time-line mr-1"></i> 2 hours 30 min
                                    <span class="mx-2">•</span>
                                    <i class="ri-file-list-line mr-1"></i> 80 marks
                                </div>
                                <div class="mt-4 flex items-center justify-between">
                                    <button
                                        class="text-primary hover:text-primaryDark hover:underline text-sm font-medium">
                                        View Paper
                                    </button>
                                    <div class="flex space-x-2">
                                        <button
                                            class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white">
                                            <i class="ri-bookmark-line"></i>
                                        </button>
                                        <button
                                            class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white">
                                            <i class="ri-download-line"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 px-4 py-2 flex justify-between">
                                <span class="text-xs text-gray-500 dark:text-gray-400">
                                    <i class="ri-check-line mr-1 text-green-500"></i> Model Answers Available
                                </span>
                                <span class="text-xs text-gray-500 dark:text-gray-400">
                                    <i class="ri-eye-line mr-1"></i> 1.9k views
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 flex justify-center">
                        <nav class="inline-flex rounded-md shadow">
                            <a href="#"
                                class="px-3 py-2 rounded-l-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm font-medium text-gray-500 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                                Previous
                            </a>
                            <a href="#"
                                class="px-3 py-2 border-t border-b border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm font-medium text-primary">
                                1
                            </a>
                            <a href="#"
                                class="px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm font-medium text-gray-500 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                                2
                            </a>
                            <a href="#"
                                class="px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm font-medium text-gray-500 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                                3
                            </a>
                            <a href="#"
                                class="px-3 py-2 rounded-r-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm font-medium text-gray-500 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                                Next
                            </a>
                        </nav>
                    </div>
                </div>
            </div>

            <!-- ibicu AI Tab (NEW) -->
            <div id="ibicu-ai" class="tab-content">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 h-[calc(100vh-200px)]">
                    <!-- Left sidebar with chat history and settings -->
                    <div
                        class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 border border-gray-100 dark:border-gray-700">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-bold text-lg">ibicu AI Assistant</h3>
                            <div class="flex items-center">
                                <button id="notification-settings-btn"
                                    class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 mr-2"
                                    title="Notification Settings">
                                    <i class="ri-notification-line"></i>
                                </button>
                                <button id="ai-settings-btn"
                                    class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"
                                    title="AI Settings">
                                    <i class="ri-settings-3-line"></i>
                                </button>
                            </div>
                        </div>

                        <div class="mb-4">
                            <button id="new-chat-btn"
                                class="w-full flex items-center justify-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition duration-150">
                                <i class="ri-add-line mr-2"></i> New Chat
                            </button>
                        </div>

                        <div class="mb-3">
                            <div class="relative">
                                <input type="text" placeholder="Search conversations"
                                    class="w-full pl-8 pr-3 py-2 text-sm text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                <div class="absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none">
                                    <i class="ri-search-line text-gray-400"></i>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-2 overflow-y-auto max-h-[calc(100vh-350px)]">
                            <div class="p-2 rounded-md bg-primary/10 dark:bg-primary/20 border-l-4 border-primary">
                                <p class="font-medium text-sm">Math Homework Help</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Today, 3:45 PM</p>
                            </div>

                            <div class="p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer">
                                <p class="font-medium text-sm">Essay Structure</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Yesterday</p>
                            </div>

                            <div class="p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer">
                                <p class="font-medium text-sm">Chemistry Concepts</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Oct 12, 2023</p>
                            </div>

                            <div class="p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer">
                                <p class="font-medium text-sm">Haiku AI Generated Plan</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400">Oct 15, 2023</p>
                            </div>
                        </div>

                        <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                            <h4 class="flex items-center font-medium text-sm mb-2">
                                Suggested Prompts:
                                <span
                                    class="text-xs ml-2 px-1.5 py-0.5 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300 rounded">Cloud
                                    Haiku AI</span>
                            </h4>
                            <div class="space-y-2">
                                <button
                                    class="w-full text-left p-2 text-xs bg-gray-50 dark:bg-gray-700 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600">
                                    Help me understand trigonometric functions
                                </button>
                                <button
                                    class="w-full text-left p-2 text-xs bg-gray-50 dark:bg-gray-700 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600">
                                    Create a study plan for my upcoming exam
                                </button>
                                <button
                                    class="w-full text-left p-2 text-xs bg-gray-50 dark:bg-gray-700 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600">
                                    Explain photosynthesis in simple terms
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Chat area -->
                    <div
                        class="md:col-span-3 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col h-full">
                        <!-- Chat header -->
                        <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div
                                        class="h-8 w-8 rounded-full bg-primary text-white flex items-center justify-center mr-3">
                                        <i class="ri-robot-line"></i>
                                    </div>
                                    <div>
                                        <h3 class="font-medium">ibicu AI</h3>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Powered by Cloud Haiku AI
                                        </p>
                                    </div>
                                </div>
                                <div>
                                    <button id="reminder-btn"
                                        class="text-xs text-primary border border-primary px-2 py-1 rounded hover:bg-primary hover:text-white transition duration-150">
                                        <i class="ri-alarm-line mr-1"></i> Set Reminder
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Chat messages -->
                        <div id="chat-messages" class="flex-grow p-4 overflow-y-auto space-y-4">
                            <!-- Welcome message -->
                            <div class="flex items-start">
                                <div
                                    class="h-8 w-8 rounded-full bg-primary text-white flex items-center justify-center mt-1 mr-2">
                                    <i class="ri-robot-line"></i>
                                </div>
                                <div class="chat-bubble-ai bg-gray-100 dark:bg-gray-700 p-3 max-w-[80%]">
                                    <p>👋 Hi there! I'm ibicu AI, your personal study assistant powered by Cloud Haiku
                                        AI. How can I help you with your studies today?</p>
                                </div>
                            </div>

                            <!-- Example conversation -->
                            <div class="flex justify-end">
                                <div class="chat-bubble-user bg-primary text-white p-3 max-w-[80%]">
                                    <p>I'm having trouble with algebra equations. Can you help me?</p>
                                </div>
                            </div>

                            <div class="flex items-start">
                                <div
                                    class="h-8 w-8 rounded-full bg-primary text-white flex items-center justify-center mt-1 mr-2">
                                    <i class="ri-robot-line"></i>
                                </div>
                                <div class="chat-bubble-ai bg-gray-100 dark:bg-gray-700 p-3 max-w-[80%]">
                                    <p>Of course! I'd be happy to help with algebra equations. Let's start with the
                                        basics:</p>
                                    <p class="mt-2">Algebra is all about finding the unknown values (usually represented
                                        by letters like x or y). The key is to isolate the variable by performing the
                                        same operations on both sides of the equation.</p>
                                    <p class="mt-2">For example, to solve 2x + 5 = 13:</p>
                                    <ol class="mt-2 ml-4 list-decimal">
                                        <li>Subtract 5 from both sides: 2x = 8</li>
                                        <li>Divide both sides by 2: x = 4</li>
                                    </ol>
                                    <p class="mt-2">Would you like to try a practice problem together? Or is there a
                                        specific type of equation you're struggling with?</p>
                                </div>
                            </div>
                        </div>

                        <!-- Chat input -->
                        <div class="p-4 border-t border-gray-200 dark:border-gray-700">
                            <div class="relative">
                                <textarea id="chat-input" rows="3" placeholder="Type your question here..."
                                    class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"></textarea>
                                <div class="absolute bottom-2 right-2 flex space-x-2">
                                    <button id="chat-send-btn"
                                        class="p-2 rounded-full bg-primary text-white hover:bg-primaryDark">
                                        <i class="ri-send-plane-fill"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between mt-2 text-xs text-gray-500 dark:text-gray-400">
                                <span>Your messages will be processed using Cloud Haiku AI</span>
                                <button id="clear-chat-btn" class="text-primary hover:underline">Clear chat</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Portal Tab (NEW) -->
            <div id="admin" class="tab-content">
                <div
                    class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700 mb-6">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h2 class="text-xl font-bold">Admin Portal</h2>
                            <p class="text-gray-600 dark:text-gray-300">Manage content, users, and settings for ibicu
                                StudyFlow</p>
                        </div>
                        <div>
                            <button id="admin-logout-btn"
                                class="inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
                                <i class="ri-logout-box-line mr-1"></i> Logout
                            </button>
                        </div>
                    </div>

                    <!-- Admin tabs -->
                    <div class="border-b border-gray-200 dark:border-gray-700 mb-6">
                        <ul class="flex flex-wrap -mb-px">
                            <li class="mr-2">
                                <button
                                    class="admin-tab-btn inline-block py-2 px-4 font-medium text-sm border-b-2 border-primary text-primary"
                                    data-tab="content">Content Management</button>
                            </li>
                            <li class="mr-2">
                                <button
                                    class="admin-tab-btn inline-block py-2 px-4 font-medium text-sm border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"
                                    data-tab="users">User Management</button>
                            </li>
                            <li class="mr-2">
                                <button
                                    class="admin-tab-btn inline-block py-2 px-4 font-medium text-sm border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"
                                    data-tab="analytics">Analytics</button>
                            </li>
                            <li class="mr-2">
                                <button
                                    class="admin-tab-btn inline-block py-2 px-4 font-medium text-sm border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"
                                    data-tab="notifications">Email Notifications</button>
                            </li>
                        </ul>
                    </div>

                    <!-- Content management tab -->
                    <div id="admin-content" class="admin-tab-content">
                        <div class="flex justify-between mb-4">
                            <h3 class="text-lg font-medium">Content Management</h3>
                            <button id="add-content-btn"
                                class="inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primaryDark">
                                <i class="ri-add-line mr-1"></i> Add New Content
                            </button>
                        </div>

                        <!-- Content type selector -->
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Content
                                Type</label>
                            <select id="content-type"
                                class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                <option value="pastpapers">Past Papers</option>
                                <option value="examples">Example Questions</option>
                                <option value="resources">Study Resources</option>
                                <option value="music">Study Music</option>
                                <option value="quotes">Motivational Quotes</option>
                                <option value="bible">Bible Verses</option>
                            </select>
                        </div>

                        <!-- Add New Content Form (initially hidden) -->
                        <div id="add-content-form"
                            class="p-4 border border-gray-200 dark:border-gray-700 rounded-lg mb-4 hidden">
                            <h4 class="font-medium mb-3">Add New Content</h4>
                            <!-- Form fields change based on content type -->
                            <div id="pastpaper-form">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label
                                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                                        <input type="text" id="paper-title"
                                            class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                                            placeholder="e.g., Mathematics Paper 1">
                                    </div>
                                    <div>
                                        <label
                                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Subject</label>
                                        <select id="paper-subject-input"
                                            class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                            <option value="math">Mathematics</option>
                                            <option value="physics">Physics</option>
                                            <option value="chemistry">Chemistry</option>
                                            <option value="biology">Biology</option>
                                            <option value="english">English</option>
                                            <option value="history">History</option>
                                            <option value="geography">Geography</option>
                                            <option value="cs">Computer Science</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                    <div>
                                        <label
                                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Exam
                                            Level</label>
                                        <select id="paper-level-input"
                                            class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                            <option value="highschool">High School</option>
                                            <option value="gcse">GCSE</option>
                                            <option value="alevel">A-Level</option>
                                            <option value="university">University</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label
                                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Year</label>
                                        <select id="paper-year-input"
                                            class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                            <option value="2023">2023</option>
                                            <option value="2022">2022</option>
                                            <option value="2021">2021</option>
                                            <option value="2020">2020</option>
                                            <option value="2019">2019</option>
                                            <option value="2018">2018</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label
                                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Exam
                                            Board</label>
                                        <select id="paper-board-input"
                                            class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                            <option value="aqa">AQA</option>
                                            <option value="edexcel">Edexcel</option>
                                            <option value="ocr">OCR</option>
                                            <option value="wjec">WJEC</option>
                                            <option value="cambridge">Cambridge</option>
                                            <option value="ib">IB</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label
                                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Upload
                                            Paper (PDF)</label>
                                        <div class="flex">
                                            <input type="file" id="paper-file"
                                                class="block w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                        </div>
                                    </div>
                                    <div>
                                        <label
                                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Upload
                                            Mark Scheme (PDF, optional)</label>
                                        <div class="flex">
                                            <input type="file" id="markscheme-file"
                                                class="block w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Music form (initially hidden) -->
                            <div id="music-form" class="hidden">
                                <div class="grid grid-cols-1 gap-4 mb-4">
                                    <div>
                                        <label
                                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Music
                                            Title</label>
                                        <input type="text" id="music-title"
                                            class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                                            placeholder="e.g., Focus Study Beats">
                                    </div>
                                    <div>
                                        <label
                                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Music
                                            URL (YouTube, SoundCloud, etc.)</label>
                                        <input type="text" id="music-url-admin"
                                            class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                                            placeholder="Paste URL here">
                                    </div>
                                    <div>
                                        <label
                                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Category</label>
                                        <select id="music-category"
                                            class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700">
                                            <option value="lofi">Lo-Fi</option>
                                            <option value="classical">Classical</option>
                                            <option value="ambient">Ambient</option>
                                            <option value="nature">Nature Sounds</option>
                                            <option value="white-noise">White Noise</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="flex justify-end space-x-3 mt-4">
                                <button id="cancel-add-content"
                                    class="px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700">
                                    Cancel
                                </button>
                                <button id="save-new-content"
                                    class="px-3 py-2 text-sm bg-primary text-white rounded hover:bg-primaryDark">
                                    <i class="ri-save-line mr-1"></i> Save
                                </button>
                            </div>
                        </div>

                        <!-- Content list -->
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg overflow-hidden">
                            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600">
                                <thead class="bg-gray-100 dark:bg-gray-800">
                                    <tr>
                                        <th scope="col"
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                            Title</th>
                                        <th scope="col"
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                            Type</th>
                                        <th scope="col"
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                            Date Added</th>
                                        <th scope="col"
                                            class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                            Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <tr>
                                        <td
                                            class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white">
                                            Mathematics Paper 1 (A-Level)</td>
                                        <td
                                            class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                                            Past Paper</td>
                                        <td
                                            class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                                            Oct 15, 2023</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                            <button class="text-primary hover:text-primaryDark">Edit</button>
                                            <button class="text-red-600 hover:text-red-800 ml-3">Delete</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td
                                            class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white">
                                            Biology Practice Questions</td>
                                        <td
                                            class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                                            Example Questions</td>
                                        <td
                                            class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                                            Oct 12, 2023</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                            <button class="text-primary hover:text-primaryDark">Edit</button>
                                            <button class="text-red-600 hover:text-red-800 ml-3">Delete</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td
                                            class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white">
                                            Chemistry Study Guide</td>
                                        <td
                                            class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                                            Study Resource</td>
                                        <td
                                            class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                                            Oct 10, 2023</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                            <button class="text-primary hover:text-primaryDark">Edit</button>
                                            <button class="text-red-600 hover:text-red-800 ml-3">Delete</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td
                                            class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white">
                                            Lo-Fi Study Beats</td>
                                        <td
                                            class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                                            Study Music</td>
                                        <td
                                            class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                                            Oct 5, 2023</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                            <button class="text-primary hover:text-primaryDark">Edit</button>
                                            <button class="text-red-600 hover:text-red-800 ml-3">Delete</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- User management tab (hidden by default) -->
                    <div id="admin-users" class="admin-tab-content hidden">
                        <h3 class="text-lg font-medium mb-4">User Management</h3>
                        <!-- User management content would go here -->
                        <p class="text-gray-600 dark:text-gray-400">Manage user accounts, permissions, and
                            subscriptions.</p>
                    </div>

                    <!-- Analytics tab (hidden by default) -->
                    <div id="admin-analytics" class="admin-tab-content hidden">
                        <h3 class="text-lg font-medium mb-4">Analytics</h3>
                        <!-- Analytics content would go here -->
                        <p class="text-gray-600 dark:text-gray-400">View usage statistics and performance metrics.</p>
                    </div>

                    <!-- Notifications tab (hidden by default) -->
                    <div id="admin-notifications" class="admin-tab-content hidden">
                        <h3 class="text-lg font-medium mb-4">Email Notification Management</h3>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                                <h4 class="font-medium mb-2">Notification Templates</h4>
                                <div class="space-y-2">
                                    <div
                                        class="p-2 border border-gray-200 dark:border-gray-600 rounded bg-white dark:bg-gray-800 flex justify-between items-center">
                                        <span>Study Reminder</span>
                                        <button class="text-primary text-sm hover:underline">Edit</button>
                                    </div>
                                    <div
                                        class="p-2 border border-gray-200 dark:border-gray-600 rounded bg-white dark:bg-gray-800 flex justify-between items-center">
                                        <span>Assignment Due</span>
                                        <button class="text-primary text-sm hover:underline">Edit</button>
                                    </div>
                                    <div
                                        class="p-2 border border-gray-200 dark:border-gray-600 rounded bg-white dark:bg-gray-800 flex justify-between items-center">
                                        <span>Weekly Progress Report</span>
                                        <button class="text-primary text-sm hover:underline">Edit</button>
                                    </div>
                                </div>
                                <button class="mt-3 text-sm text-primary hover:underline flex items-center">
                                    <i class="ri-add-line mr-1"></i> Add New Template
                                </button>
                            </div>

                            <div>
                                <h4 class="font-medium mb-2">Scheduled Emails</h4>
                                <div class="mb-4">
                                    <div class="flex items-center justify-between">
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">Next batch of study
                                            reminders:</p>
                                        <span class="text-sm font-medium">Tomorrow, 9:00 AM</span>
                                    </div>
                                    <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                        <div class="bg-primary h-2 rounded-full" style="width: 75%"></div>
                                    </div>
                                </div>

                                <button
                                    class="w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primaryDark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition duration-150">
                                    <i class="ri-mail-send-line mr-2"></i> Send Test Email
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-white dark:bg-gray-900 mt-8 py-6 border-t border-gray-200 dark:border-gray-800">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p class="text-center md:text-left text-sm text-gray-500 dark:text-gray-400 mb-4 md:mb-0">
                        © 2023 ibicu StudyFlow | AI-Powered Student Companion
                    </p>
                    <div class="flex items-center space-x-6">
                        <a href="#"
                            class="text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100">
                            <i class="ri-github-fill text-lg"></i>
                        </a>
                        <a href="#"
                            class="text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100">
                            <i class="ri-twitter-fill text-lg"></i>
                        </a>
                        <a href="#"
                            class="text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100">
                            <i class="ri-instagram-fill text-lg"></i>
                        </a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Toast Notification -->
    <div id="toast"
        class="toast hidden rounded-lg bg-white dark:bg-gray-800 shadow-lg p-4 max-w-md w-full border border-gray-100 dark:border-gray-700">
        <div class="flex items-center">
            <div id="toast-icon-success"
                class="hidden flex-shrink-0 w-8 h-8 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center mr-3">
                <i class="ri-check-line text-green-600 dark:text-green-400 text-lg"></i>
            </div>
            <div id="toast-icon-error"
                class="hidden flex-shrink-0 w-8 h-8 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center mr-3">
                <i class="ri-close-line text-red-600 dark:text-red-400 text-lg"></i>
            </div>
            <div id="toast-icon-info"
                class="hidden flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center mr-3">
                <i class="ri-information-line text-blue-600 dark:text-blue-400 text-lg"></i>
            </div>
            <div class="flex-1">
                <p id="toast-title" class="font-medium text-gray-900 dark:text-white"></p>
                <p id="toast-message" class="text-sm text-gray-600 dark:text-gray-300"></p>
            </div>
            <button id="close-toast" class="ml-4 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
                <i class="ri-close-line"></i>
            </button>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="admin-login-modal" class="fixed inset-0 z-50 overflow-y-auto hidden">
        <div class="flex items-center justify-center min-h-screen">
            <div class="fixed inset-0 bg-black bg-opacity-50 transition-opacity modal-backdrop" aria-hidden="true">
            </div>

            <div
                class="bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-xl transform transition-all sm:max-w-lg sm:w-full modal-content">
                <div class="px-6 py-5 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white">Admin Login</h3>
                </div>
                <div class="px-6 py-4">
                    <form id="admin-login-form">
                        <div class="mb-4">
                            <label
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Username</label>
                            <input type="text" id="admin-username"
                                class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                                placeholder="Enter your username">
                        </div>
                        <div class="mb-4">
                            <label
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Password</label>
                            <input type="password" id="admin-password"
                                class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                                placeholder="Enter your password">
                        </div>
                        <div id="admin-login-error" class="text-red-500 text-sm mb-4 hidden">
                            Invalid username or password.
                        </div>
                        <div class="bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md mb-4">
                            <p class="text-blue-800 dark:text-blue-200 text-sm flex items-start">
                                <i class="ri-information-line mt-0.5 mr-2"></i>
                                <span>Default login credentials:<br>
                                    Username: <strong>admin</strong><br>
                                    Password: <strong>password</strong></span>
                            </p>
                        </div>
                    </form>
                </div>
                <div class="px-6 py-4 bg-gray-50 dark:bg-gray-700 sm:flex sm:flex-row-reverse">
                    <button id="admin-login-submit-btn"
                        class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary text-base font-medium text-white hover:bg-primaryDark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary sm:ml-3 sm:w-auto sm:text-sm">
                        Login
                    </button>
                    <button id="admin-login-cancel-btn"
                        class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-800 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Email Notification Modal -->
    <div id="email-notification-modal" class="fixed inset-0 z-50 overflow-y-auto hidden notification-modal">
        <div class="flex items-center justify-center min-h-screen">
            <div class="fixed inset-0 bg-black bg-opacity-50 transition-opacity modal-backdrop" aria-hidden="true">
            </div>

            <div
                class="bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-xl transform transition-all sm:max-w-lg sm:w-full modal-content">
                <div class="px-6 py-5 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white">Email Notification Settings</h3>
                </div>
                <div class="px-6 py-4">
                    <form id="notification-form">
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email
                                Address</label>
                            <input type="email" id="notification-email"
                                class="w-full px-3 py-2 text-base text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary focus:border-primary bg-white dark:bg-gray-700"
                                placeholder="Enter your email address">
                        </div>

                        <div class="mb-6">
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">Notification preferences:</p>
                            <div class="space-y-2">
                                <div class="flex items-center">
                                    <input id="notify-deadlines" type="checkbox"
                                        class="h-4 w-4 text-primary rounded border-gray-300 dark:border-gray-600 focus:ring-primary">
                                    <label for="notify-deadlines" class="ml-2 text-sm text-gray-700 dark:text-gray-300">
                                        Deadline reminders
                                    </label>
                                </div>
                                <div class="flex items-center">
                                    <input id="notify-schedules" type="checkbox"
                                        class="h-4 w-4 text-primary rounded border-gray-300 dark:border-gray-600 focus:ring-primary">
                                    <label for="notify-schedules" class="ml-2 text-sm text-gray-700 dark:text-gray-300">
                                        Study schedule updates
                                    </label>
                                </div>
                                <div class="flex items-center">
                                    <input id="notify-pomodoro" type="checkbox"
                                        class="h-4 w-4 text-primary rounded border-gray-300 dark:border-gray-600 focus:ring-primary">
                                    <label for="notify-pomodoro" class="ml-2 text-sm text-gray-700 dark:text-gray-300">
                                        Pomodoro session reminders
                                    </label>
                                </div>
                                <div class="flex items-center">
                                    <input id="notify-motivation" type="checkbox"
                                        class="h-4 w-4 text-primary rounded border-gray-300 dark:border-gray-600 focus:ring-primary">
                                    <label for="notify-motivation"
                                        class="ml-2 text-sm text-gray-700 dark:text-gray-300">
                                        Daily motivation messages
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div
                            class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-900 rounded-lg p-3">
                            <p class="text-sm text-blue-800 dark:text-blue-200">
                                <i class="ri-information-line mr-1"></i>
                                Email notifications are sent by our secure server. You can unsubscribe at any time.
                            </p>
                        </div>
                    </form>
                </div>
                <div class="px-6 py-4 bg-gray-50 dark:bg-gray-700 sm:flex sm:flex-row-reverse">
                    <button id="notification-save-btn"
                        class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary text-base font-medium text-white hover:bg-primaryDark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary sm:ml-3 sm:w-auto sm:text-sm">
                        Save Preferences
                    </button>
                    <button id="notification-cancel-btn"
                        class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-800 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:mt-0 sm:w-auto sm:text-sm">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dark mode detection and toggle
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }

        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        document.getElementById('theme-toggle').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
        });

        // Tab navigation
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const tab = button.dataset.tab;

                // Remove active class from all buttons and contents
                tabButtons.forEach(btn => btn.classList.remove('text-primary', 'border-primary'));
                tabButtons.forEach(btn => btn.classList.add('border-transparent'));
                tabContents.forEach(content => content.classList.remove('active'));

                // Add active class to selected button and content
                button.classList.add('text-primary', 'border-primary');
                button.classList.remove('border-transparent');
                document.getElementById(tab).classList.add('active');
            });
        });

        // Tab links from dashboard
        const tabLinks = document.querySelectorAll('.tab-link');

        tabLinks.forEach(link => {
            link.addEventListener('click', () => {
                const tab = link.dataset.tab;

                // Find and click the corresponding tab button
                const tabButton = document.querySelector(`.tab-button[data-tab="${tab}"]`);
                tabButton.click();
            });
        });

        // Toast notification functionality
        const toast = document.getElementById('toast');
        const toastTitle = document.getElementById('toast-title');
        const toastMessage = document.getElementById('toast-message');
        const toastIconSuccess = document.getElementById('toast-icon-success');
        const toastIconError = document.getElementById('toast-icon-error');
        const toastIconInfo = document.getElementById('toast-icon-info');

        function showToast(type, title, message, duration = 3000) {
            // Set toast content
            toastTitle.textContent = title;
            toastMessage.textContent = message;

            // Set the appropriate icon
            toastIconSuccess.classList.add('hidden');
            toastIconError.classList.add('hidden');
            toastIconInfo.classList.add('hidden');

            if (type === 'success') {
                toastIconSuccess.classList.remove('hidden');
            } else if (type === 'error') {
                toastIconError.classList.remove('hidden');
            } else if (type === 'info') {
                toastIconInfo.classList.remove('hidden');
            }

            // Show the toast
            toast.classList.remove('hidden');

            // Automatically hide after duration
            setTimeout(() => {
                toast.classList.add('hidden');
            }, duration);
        }

        document.getElementById('close-toast').addEventListener('click', () => {
            toast.classList.add('hidden');
        });

        // AI-powered Quote Generator
        async function generateDailyQuote() {
            const quoteText = document.getElementById('quote-text');
            const quoteAuthor = document.getElementById('quote-author');

            // Show loading state
            quoteText.textContent = "Generating an inspirational quote for you...";
            quoteAuthor.textContent = "";

            // Register handler for the AI response
            window.Poe.registerHandler("quote-handler", (result) => {
                const response = result.responses[0];

                if (response.status === "error") {
                    quoteText.textContent = "\"The best preparation for tomorrow is doing your best today.\"";
                    quoteAuthor.textContent = "- H. Jackson Brown Jr.";
                    showToast('error', 'Error', 'Could not generate a new quote. Using default instead.');
                }
                else if (response.status === "complete") {
                    try {
                        // Parse response for quote and author
                        const content = response.content;
                        const quoteMatch = content.match(/"([^"]+)"/);
                        const authorMatch = content.match(/- ([^\.]+)/);

                        if (quoteMatch && authorMatch) {
                            quoteText.textContent = `"${quoteMatch[1]}"`;
                            quoteAuthor.textContent = `- ${authorMatch[1].trim()}`;
                        } else {
                            throw new Error("Could not parse quote format");
                        }
                    } catch (e) {
                        // Fallback to default quote
                        quoteText.textContent = "\"The future belongs to those who believe in the beauty of their dreams.\"";
                        quoteAuthor.textContent = "- Eleanor Roosevelt";
                    }
                }
            });

            try {
                await window.Poe.sendUserMessage(`@Claude-3.5-Haiku Generate a motivational quote for students with the author. Format as: "Quote" - Author. Keep the quote concise, under 15 words, and focused on study motivation, success, or personal growth.`, {
                    handler: "quote-handler",
                    stream: false,
                    openChat: false
                });
            } catch (error) {
                // Fallback to default quote
                quoteText.textContent = "\"The only way to do great work is to love what you do.\"";
                quoteAuthor.textContent = "- Steve Jobs";
                console.error("Error generating quote:", error);
            }
        }

        // Random quotes (non-AI backup)
        const quotes = [
            { text: "The secret of getting ahead is getting started.", author: "Mark Twain" },
            { text: "It always seems impossible until it's done.", author: "Nelson Mandela" },
            { text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney" },
            { text: "Don't let yesterday take up too much of today.", author: "Will Rogers" },
            { text: "You don't have to be great to start, but you have to start to be great.", author: "Zig Ziglar" },
            { text: "The more that you read, the more things you will know. The more that you learn, the more places you'll go.", author: "Dr. Seuss" },
            { text: "Education is the most powerful weapon which you can use to change the world.", author: "Nelson Mandela" },
            { text: "The beautiful thing about learning is that nobody can take it away from you.", author: "B.B. King" },
            { text: "Success is not final, failure is not fatal: It is the courage to continue that counts.", author: "Winston Churchill" },
            { text: "The only limit to our realization of tomorrow will be our doubts of today.", author: "Franklin D. Roosevelt" },
            { text: "The future belongs to those who believe in the beauty of their dreams.", author: "Eleanor Roosevelt" },
            { text: "Your time is limited, don't waste it living someone else's life.", author: "Steve Jobs" }
        ];

        // Bible verses
        const bibleVerses = [
            { text: "For I know the plans I have for you, declares the LORD, plans to prosper you and not to harm you, plans to give you hope and a future.", reference: "Jeremiah 29:11" },
            { text: "I can do all things through Christ who strengthens me.", reference: "Philippians 4:13" },
            { text: "Trust in the LORD with all your heart and lean not on your own understanding; in all your ways submit to him, and he will make your paths straight.", reference: "Proverbs 3:5-6" },
            { text: "But those who hope in the LORD will renew their strength. They will soar on wings like eagles; they will run and not grow weary, they will walk and not be faint.", reference: "Isaiah 40:31" },
            { text: "Be strong and courageous. Do not be afraid; do not be discouraged, for the LORD your God will be with you wherever you go.", reference: "Joshua 1:9" },
            { text: "And we know that in all things God works for the good of those who love him, who have been called according to his purpose.", reference: "Romans 8:28" },
            { text: "For God so loved the world that he gave his one and only Son, that whoever believes in him shall not perish but have eternal life.", reference: "John 3:16" },
            { text: "Therefore, if anyone is in Christ, the new creation has come: The old has gone, the new is here!", reference: "2 Corinthians 5:17" },
            { text: "But seek first his kingdom and his righteousness, and all these things will be given to you as well.", reference: "Matthew 6:33" },
            { text: "May the God of hope fill you with all joy and peace as you trust in him, so that you may overflow with hope by the power of the Holy Spirit.", reference: "Romans 15:13" }
        ];

        function getRandomQuote() {
            return quotes[Math.floor(Math.random() * quotes.length)];
        }

        function getRandomBibleVerse() {
            return bibleVerses[Math.floor(Math.random() * bibleVerses.length)];
        }

        function updateQuote(quoteElement, authorElement) {
            const quote = getRandomQuote();
            quoteElement.textContent = `"${quote.text}"`;
            authorElement.textContent = `- ${quote.author}`;
        }

        function updateBibleVerse(verseElement, referenceElement) {
            const verse = getRandomBibleVerse();
            verseElement.textContent = `"${verse.text}"`;
            referenceElement.textContent = `- ${verse.reference}`;
        }

        // Update dashboard quote
        const quoteText = document.getElementById('quote-text');
        const quoteAuthor = document.getElementById('quote-author');

        document.getElementById('new-quote-btn').addEventListener('click', () => {
            generateDailyQuote();
        });

        // Update Bible verse
        const bibleVerseText = document.getElementById('bible-verse-text');
        const bibleVerseReference = document.getElementById('bible-verse-reference');

        document.getElementById('new-verse-btn').addEventListener('click', () => {
            updateBibleVerse(bibleVerseText, bibleVerseReference);
        });

        // Motivational tab quote
        const motivationQuoteCard = document.getElementById('motivation-quote-card');
        const motivationQuoteText = motivationQuoteCard.querySelector('.quote-text');
        const motivationQuoteAuthor = motivationQuoteCard.querySelector('.text-right');

        document.getElementById('motivate-me-btn').addEventListener('click', () => {
            generateDailyQuote();
            updateBibleVerse(bibleVerseText, bibleVerseReference);
            showToast('success', 'Motivation Delivered!', 'Keep up the great work and stay motivated!');
        });

        // Pomodoro Timer
        let timerInterval;
        let timeLeft = 25 * 60; // 25 minutes in seconds
        let isRunning = false;
        let isBreak = false;

        const timerDisplay = document.getElementById('timer-display');
        const timerLabel = document.getElementById('timer-label');
        const startButton = document.getElementById('timer-start');
        const pauseButton = document.getElementById('timer-pause');
        const resetButton = document.getElementById('timer-reset');
        const focusDuration = document.getElementById('focus-duration');
        const breakDuration = document.getElementById('break-duration');
        const timerProgress = document.getElementById('timer-progress');

        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

            // Update progress circle
            const totalTime = isBreak ? (parseInt(breakDuration.value) * 60) : (parseInt(focusDuration.value) * 60);
            const progress = ((totalTime - timeLeft) / totalTime) * 100;
            timerProgress.style.clipPath = `inset(0 0 0 ${progress}%)`;
        }

        function startTimer() {
            if (isRunning) return;

            isRunning = true;
            startButton.disabled = true;
            pauseButton.disabled = false;
            resetButton.disabled = false;

            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    isRunning = false;

                    // Play sound
                    const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PqtGYcBjiR1e7OeSwFJHfH8N2QQAoUXrTp66hVFApGn+DsvnEiBzOL0PDTgjMGHm7A7+GWRgsRVq/n7axaGAg+mN/twHMlBTGGzvLaizsIGWu98OihUBELTqXj6rRnHQU2ktXuz3ssBSJ6x/DdkEELFV2z6eusVxQKRJ/h68BzIwUzjdDw1IIzBh5uwO/hlUYMEFWv5+ytWxgIPJjf7cFzJgYxhc7y2os7CBhsvfDooe+JSxELTqXj6bNkHQY2kdXv0HssBSJ6x/DdkEEKFF206OurVxQKRZ/h68BzIwU0jdDw1IIzBh5vwO/hlUYMEVav5+ytWxgIPZjf7cBzJQUxhs7x2os6CBhsvfDooe+fThELT6Xj6bNnHQY3kdXuz3ssBSJ6yPDdkEEKFF206OurVxULRJ/h68BzIwU0jdDv1IIzBx5vwO/hlUYMEVav5+2sWxgIPJjf7sFzJgUxhc7y2os7CBhsvfDooe+fTxELTqXj6rRnHQY3kdXuz3ssBSJ6yPDdkEEKFF206OurVxULRJ/h7MBzIwU0jdDw1IIyBh5vwO/ilUYMEVav5+2sWxgJPJjf7sFyJgUxhc7y2os7CBhsvfDoou+fTxEKTqXj6rNnHQY3kdXvz3ssBCJ6yPDdkEEKFF206OurVxULRJ/h7MByIwU0jdDw1IIyBh5vwO/ilUYMEFWv5+2tXBgIPJng7cFyJgUxhc7y2os7CBhsvfDoou+fTxIMT6Xj6rNmHQY3kdXvz3ssBCJ6yPHdkEEKFF206OurVxULRJ/h7MFyIwU0jdDw1IEyBh9vwe/ilUYMEFWv5+2tXBgIPJng7cFyJgUxhc7y2os7CBhsvfDoou+fTxIMT6Xj6rNmHQY3kdXvz3ssBCJ6yPDekUEKFF206OurVxULRJ/h7MFyIwU0jdDw1IEyBh9vwe/ilUYMEFWv5+2tXBgIPJng7cFyJgUxhc7y2os7CBhsvfDoou+fTxILTqXj6rNmHQY3kdXvz3ssBCJ7yPDekUEKFF206OurVxULRJ/h7MFyIwU0jdDw1IEyBh9vwe/ilUYMEFWv5+2tXBgIPJrf7cFyJgUxhc7y2os7CBhsvfDoou+fTxILTqXj6rNmHQY3kdXvz3osBCJ7yPDekUEKFF206OurVxULRJ/h7MFyIwU0jdDw1IEyBh9vwe/ilkYMEFWv5+2tXBgIPJrf7cFyJgUxhc7y2os7CBhsvfDoou+fTxILTqXj6rNmHQY3kdXvz3osBCJ7yPDekUAKFF207OurVxULRJ/h7MFyIwU0jdDw1IEyBh9vwe/ilkUMEFWv5+2tXBgIPJrf7cFyJgUxhc7y2os7CBhsvfDoou+fTxILTqXk67NmHQY3kdXvz3osBCJ7yPDekUAKFF207OurVxULRJ/h7MFyIwU0jdDw1IEyBh9vwe/ilkUMEFWv5+2tXBgIPJrf7cJyJgUxhc7y2os7CBhsvfDoou+fTxILTqXk67NmHQY3kdXvz3osBCJ7yPDekUAKFF207OurVxULRJ/h7MFyIwU0jdDw1IEyBh9vwe/ilkUMEFWv5+2tXBgIPJrf7cJyJgUxhc7y2os7CBhsvfDoou+fTxILTqXk67NmHQY3kdXvz3osBCJ7yPDekUAKFF207OurVxULRJ/h7MFyIwU0jdDw1IEyBh9vwe/jlkUMEFWv5+2tXBgIPJrf7cJyJgUxhc7y2os7CBhsvfDoou+fTxILTqXk67RmHQY3kdXvz3osBCJ7yPDekUAKFF207OurVxULRJ/h7MFyIwU0jdDw1IEyBh9vwe/jlkUMEFWv5+2tXBgIPZrf7cJyJgUxhc7y2os7CBhsvfDoou+fTxILTqXk67RmHQY3kdXvz3orBCJ7yPDekUAKFF207OurVxULRJ/h7MFyIwY0jdDw1IAyBR9vwe/jlkUMEFWv5+2tXBgIPZrg7cJyJgUxhc7y2os7CBhsvfDoou+fTxILTaXk67RmHQY2kdXvz3orBCJ7yPDekUAKE120AAAAygEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');
                    audio.play();

                    // Show notification
                    if (isBreak) {
                        showToast('info', 'Break Ended', 'Time to get back to work!');
                    } else {
                        showToast('success', 'Focus Session Complete', 'Time for a well-deserved break!');
                    }

                    // Toggle between focus and break
                    isBreak = !isBreak;

                    if (isBreak) {
                        timeLeft = parseInt(breakDuration.value) * 60;
                        timerLabel.textContent = "Break Time";
                        timerProgress.style.borderColor = "#22c55e"; // Green
                    } else {
                        timeLeft = parseInt(focusDuration.value) * 60;
                        timerLabel.textContent = "Focus Time";
                        timerProgress.style.borderColor = "#5D5CDE"; // Primary color
                    }

                    updateTimerDisplay();
                    startButton.disabled = false;
                }
            }, 1000);
        }

        function pauseTimer() {
            clearInterval(timerInterval);
            isRunning = false;
            startButton.disabled = false;
            pauseButton.disabled = true;
        }

        function resetTimer() {
            clearInterval(timerInterval);
            isRunning = false;
            isBreak = false;
            timeLeft = parseInt(focusDuration.value) * 60;
            timerLabel.textContent = "Focus Time";
            timerProgress.style.borderColor = "#5D5CDE";
            updateTimerDisplay();
            startButton.disabled = false;
            pauseButton.disabled = true;
            resetButton.disabled = true;
        }

        startButton.addEventListener('click', startTimer);
        pauseButton.addEventListener('click', pauseTimer);
        resetButton.addEventListener('click', resetTimer);

        focusDuration.addEventListener('change', function () {
            if (!isRunning && !isBreak) {
                timeLeft = parseInt(this.value) * 60;
                updateTimerDisplay();
            }
        });

        breakDuration.addEventListener('change', function () {
            if (!isRunning && isBreak) {
                timeLeft = parseInt(this.value) * 60;
                updateTimerDisplay();
            }
        });

        // Enhanced Music Player Functionality
        const musicPlayer = document.getElementById('music-player');
        const openMusicPlayerBtn = document.getElementById('open-music-player-btn');
        const closeMusicPlayerBtn = document.getElementById('close-music-player-btn');
        const musicUrlInput = document.getElementById('music-url');
        const addMusicUrlBtn = document.getElementById('add-music-url-btn');
        const musicList = document.getElementById('music-list');
        const musicVolume = document.getElementById('music-volume');
        const volumeValue = document.getElementById('volume-value');
        const playMusicBtn = document.getElementById('play-music-btn');
        const pauseMusicBtn = document.getElementById('pause-music-btn');
        const stopMusicBtn = document.getElementById('stop-music-btn');
        const currentMusic = document.getElementById('current-music');

        // Create audio element
        const audioPlayer = new Audio();
        let currentPlayingButton = null;
        let mediaSource = null;

        // Set initial volume
        audioPlayer.volume = 0.5;

        // Open music player
        openMusicPlayerBtn.addEventListener('click', function () {
            musicPlayer.classList.remove('hidden');
        });

        // Close music player
        closeMusicPlayerBtn.addEventListener('click', function () {
            musicPlayer.classList.add('hidden');
        });

        // Update volume
        musicVolume.addEventListener('input', function () {
            const vol = this.value / 100;
            audioPlayer.volume = vol;
            volumeValue.textContent = `${this.value}%`;
        });

        // Helper function to extract YouTube video ID
        function getYouTubeID(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        // Initialize music play buttons
        const setupMusicButtons = () => {
            const musicPlayButtons = document.querySelectorAll('.music-play-btn');

            musicPlayButtons.forEach(button => {
                button.addEventListener('click', function () {
                    const icon = this.querySelector('i');
                    const trackName = this.parentElement.querySelector('span')?.textContent || 'Custom Track';

                    // If already playing this track
                    if (currentPlayingButton === this && !audioPlayer.paused) {
                        audioPlayer.pause();
                        icon.className = 'ri-play-fill';
                        return;
                    }

                    // Reset all other buttons
                    musicPlayButtons.forEach(btn => {
                        btn.querySelector('i').className = 'ri-play-fill';
                    });

                    // Set this button to playing
                    icon.className = 'ri-pause-fill';
                    currentPlayingButton = this;

                    // In a real app, we would use real music URLs
                    // For this demo, use static music if available
                    const musicData = {
                        "Lo-Fi Study Beats": "https://cdn.pixabay.com/audio/2022/05/27/audio_1808fbf07a.mp3",
                        "Classical Piano": "https://cdn.pixabay.com/audio/2022/03/15/audio_942d7a3b6c.mp3",
                        "Nature Sounds": "https://cdn.pixabay.com/audio/2022/01/18/audio_d0f6c6c805.mp3",
                        "Lofi Beats": "https://cdn.pixabay.com/audio/2022/10/14/audio_946bc7d3fd.mp3",
                        "White Noise": "https://cdn.pixabay.com/audio/2021/08/09/audio_c79a43d6ae.mp3"
                    };

                    // Get music URL if it exists in the data, otherwise use a default
                    const musicUrl = musicData[trackName] || "https://cdn.pixabay.com/audio/2022/05/27/audio_1808fbf07a.mp3";

                    // Set the audio source and play
                    audioPlayer.src = musicUrl;
                    audioPlayer.load();
                    audioPlayer.play().then(() => {
                        currentMusic.textContent = trackName;
                        showToast('info', 'Music Started', `Now playing: ${trackName}`);
                    }).catch(error => {
                        console.error("Error playing audio:", error);
                        showToast('error', 'Playback Error', 'Could not play the selected track.');
                        icon.className = 'ri-play-fill';
                    });
                });
            });
        };

        // Call initially to set up existing buttons
        setupMusicButtons();

        // Add custom music
        addMusicUrlBtn.addEventListener('click', function () {
            const url = musicUrlInput.value.trim();
            if (!url) {
                showToast('error', 'Empty URL', 'Please enter a music URL to add.');
                return;
            }

            // Extract title from URL or use generic name
            let title = url.split('/').pop() || 'Custom Music';
            if (title.length > 30) title = title.substring(0, 27) + '...';

            // Process YouTube URLs
            let musicUrl = url;
            const youtubeID = getYouTubeID(url);
            if (youtubeID) {
                // Create embed URL for YouTube
                musicUrl = `https://www.youtube.com/embed/${youtubeID}?autoplay=1`;
            }

            // Create new music item
            const newMusic = document.createElement('div');
            newMusic.className = 'p-2 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 flex items-center justify-between';
            newMusic.innerHTML = `
                <div class="flex items-center">
                    <i class="ri-music-2-line text-primary text-lg mr-2"></i>
                    <span class="text-sm">${title}</span>
                </div>
                <button class="music-play-btn p-1.5 rounded-full bg-primary/10 hover:bg-primary/20 text-primary">
                    <i class="ri-play-fill"></i>
                </button>
            `;

            // Store the URL as a data attribute
            newMusic.dataset.url = musicUrl;

            // Add to music list
            musicList.prepend(newMusic);

            // Set up the new button's event listener
            setupMusicButtons();

            // Clear input
            musicUrlInput.value = '';

            showToast('success', 'Music Added', 'Your custom music has been added to the list.');
        });

        // Play button
        playMusicBtn.addEventListener('click', function () {
            if (audioPlayer.src && audioPlayer.paused) {
                audioPlayer.play();
                if (currentPlayingButton) {
                    currentPlayingButton.querySelector('i').className = 'ri-pause-fill';
                }
            } else {
                showToast('info', 'No Music Selected', 'Please select a track from the list first.');
            }
        });

        // Pause button
        pauseMusicBtn.addEventListener('click', function () {
            if (audioPlayer.src && !audioPlayer.paused) {
                audioPlayer.pause();
                if (currentPlayingButton) {
                    currentPlayingButton.querySelector('i').className = 'ri-play-fill';
                }
            }
        });

        // Stop button
        stopMusicBtn.addEventListener('click', function () {
            if (audioPlayer.src) {
                audioPlayer.pause();
                audioPlayer.currentTime = 0;
                if (currentPlayingButton) {
                    currentPlayingButton.querySelector('i').className = 'ri-play-fill';
                    currentPlayingButton = null;
                }
                currentMusic.textContent = 'No music selected';
            }
        });

        // AI Tutor functionality
        const askAiBtn = document.getElementById('ask-ai-btn');
        const aiResponseContainer = document.getElementById('ai-response-container');
        const aiResponseContent = document.getElementById('ai-response-content');
        const newQuestionBtn = document.getElementById('new-question-btn');
        const copyResponseBtn = document.getElementById('copy-response-btn');
        const emailResponseBtn = document.getElementById('email-response-btn');

        askAiBtn.addEventListener('click', async function () {
            const helpType = document.getElementById('help-type').value;
            const subjectArea = document.getElementById('subject-area').value;
            const question = document.getElementById('ai-question').value;

            if (!question.trim()) {
                showToast('error', 'Empty Question', 'Please enter a question or topic to continue.');
                return;
            }

            // Show the response container with loading state
            aiResponseContainer.classList.remove('hidden');
            aiResponseContent.innerHTML = `
                <div class="animate-pulse">
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"></div>
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mb-4"></div>
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6 mb-2"></div>
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-4/5 mb-4"></div>
                </div>
            `;

            // Register handler for the AI response
            window.Poe.registerHandler("ai-tutor-handler", (result) => {
                const response = result.responses[0];

                if (response.status === "error") {
                    aiResponseContent.innerHTML = `<p class="text-red-500">Error: ${response.statusText || "Failed to get a response"}</p>`;
                } else if (response.status === "incomplete") {
                    // Update with streaming content
                    aiResponseContent.innerHTML = marked.parse(response.content);
                    // Render math if present
                    if (response.content.includes('$')) {
                        MathJax.typeset([aiResponseContent]);
                    }
                } else if (response.status === "complete") {
                    // Update with final content
                    aiResponseContent.innerHTML = marked.parse(response.content);
                    // Render math if present
                    if (response.content.includes('$')) {
                        MathJax.typeset([aiResponseContent]);
                    }
                }
            });

            try {
                // Format the prompt based on the selected help type and subject
                let specialInstructions = '';
                if (helpType === 'math') {
                    specialInstructions = 'Please format any mathematical expressions using LaTeX between $ symbols for inline math or $$ for display math.';
                }

                let prompt = `@Claude-3.5-Haiku I need help with ${subjectArea}. Please ${formatHelpType(helpType)}: ${question} ${specialInstructions}`;

                // Send the message to Claude
                await window.Poe.sendUserMessage(prompt, {
                    handler: "ai-tutor-handler",
                    stream: true,
                    openChat: false
                });
            } catch (error) {
                aiResponseContent.innerHTML = `<p class="text-red-500">Error: ${error.message || "Failed to send message"}</p>`;
            }
        });

        function formatHelpType(type) {
            switch (type) {
                case 'explanation': return 'explain this concept';
                case 'summary': return 'summarize this information';
                case 'question': return 'answer this question';
                case 'example': return 'provide examples about';
                case 'practice': return 'generate practice problems on';
                case 'math': return 'solve this math problem';
                default: return 'help me understand';
            }
        }

        newQuestionBtn.addEventListener('click', function () {
            aiResponseContainer.classList.add('hidden');
            document.getElementById('ai-question').value = '';
        });

        copyResponseBtn.addEventListener('click', function () {
            const textToCopy = aiResponseContent.textContent;

            try {
                navigator.clipboard.writeText(textToCopy).then(() => {
                    // Show temporary success message
                    showToast('success', 'Copied!', 'Response copied to clipboard.');

                    // Update button temporarily
                    const originalText = copyResponseBtn.innerHTML;
                    copyResponseBtn.innerHTML = '<i class="ri-check-line mr-1"></i> Copied!';

                    setTimeout(() => {
                        copyResponseBtn.innerHTML = originalText;
                    }, 2000);
                });
            } catch (err) {
                showToast('error', 'Copy Failed', 'Could not copy to clipboard.');
                console.error('Failed to copy text: ', err);
            }
        });

        emailResponseBtn.addEventListener('click', function () {
            showEmailNotificationModal('AI Response');
        });

        // Study Planner functionality
        const generatePlanBtn = document.getElementById('generate-plan-btn');
        const studyPlanContainer = document.getElementById('study-plan-container');
        const studyPlanContent = document.getElementById('study-plan-content');
        const savePlanBtn = document.getElementById('save-plan-btn');
        const copyPlanBtn = document.getElementById('copy-plan-btn');
        const emailPlanBtn = document.getElementById('email-plan-btn');

        generatePlanBtn.addEventListener('click', async function () {
            const subjects = document.getElementById('subjects').value;
            const deadlines = document.getElementById('deadlines').value;
            const studyHours = document.getElementById('study-hours').value;
            const studyTime = document.getElementById('study-time').value;
            const preferences = document.getElementById('preferences').value;

            if (!subjects.trim()) {
                showToast('error', 'Missing Information', 'Please enter at least one subject.');
                return;
            }

            // Show the plan container with loading state
            studyPlanContainer.classList.remove('hidden');
            studyPlanContent.innerHTML = `
                <div class="animate-pulse">
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"></div>
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mb-4"></div>
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6 mb-2"></div>
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-4/5 mb-4"></div>
                </div>
            `;

            // Register handler for the AI response
            window.Poe.registerHandler("study-plan-handler", (result) => {
                const response = result.responses[0];

                if (response.status === "error") {
                    studyPlanContent.innerHTML = `<p class="text-red-500">Error: ${response.statusText || "Failed to generate a study plan"}</p>`;
                } else if (response.status === "incomplete") {
                    // Update with streaming content
                    studyPlanContent.innerHTML = marked.parse(response.content);
                } else if (response.status === "complete") {
                    // Update with final content
                    studyPlanContent.innerHTML = marked.parse(response.content);
                    showToast('success', 'Plan Generated', 'Your personalized study plan is ready!');
                }
            });

            try {
                // Format the prompt for the study plan
                let prompt = `@Claude-3.5-Haiku Generate a detailed study plan with the following information:
                
                Subjects: ${subjects}
                ${deadlines ? `Deadlines: ${deadlines}` : ''}
                Available study hours: ${studyHours} per day
                Preferred study time: ${studyTime}
                ${preferences ? `Additional preferences: ${preferences}` : ''}
                
                Create a clear, organized study schedule that includes specific times, subjects, and activities. Format the schedule in markdown with days of the week and use bullet points for each study session. Include specific study strategies for different subjects. Sign the plan as "Generated by Cloud Haiku AI for ibicu StudyFlow".`;

                // Send the message to Claude
                await window.Poe.sendUserMessage(prompt, {
                    handler: "study-plan-handler",
                    stream: true,
                    openChat: false
                });
            } catch (error) {
                studyPlanContent.innerHTML = `<p class="text-red-500">Error: ${error.message || "Failed to send message"}</p>`;
            }
        });

        savePlanBtn.addEventListener('click', function () {
            showToast('success', 'Plan Saved', 'Your study plan has been saved successfully!');
        });

        copyPlanBtn.addEventListener('click', function () {
            const textToCopy = studyPlanContent.textContent;

            try {
                navigator.clipboard.writeText(textToCopy).then(() => {
                    showToast('success', 'Copied!', 'Study plan copied to clipboard.');

                    // Update button temporarily
                    const originalText = copyPlanBtn.innerHTML;
                    copyPlanBtn.innerHTML = '<i class="ri-check-line mr-1"></i> Copied!';

                    setTimeout(() => {
                        copyPlanBtn.innerHTML = originalText;
                    }, 2000);
                });
            } catch (err) {
                showToast('error', 'Copy Failed', 'Could not copy to clipboard.');
                console.error('Failed to copy text: ', err);
            }
        });

        emailPlanBtn.addEventListener('click', function () {
            showEmailNotificationModal('Study Plan');
        });

        // Note reading functionality with Web Speech API (Enhanced for Math)
        const readNoteBtn = document.getElementById('read-note-btn');
        const pauseNoteBtn = document.getElementById('pause-note-btn');
        const stopNoteBtn = document.getElementById('stop-note-btn');
        const noteContent = document.getElementById('note-content');
        const voiceSelector = document.getElementById('voice-selector');
        const speechRate = document.getElementById('speech-rate');
        const speechPitch = document.getElementById('speech-pitch');
        const speechRateValue = document.getElementById('speech-rate-value');
        const speechPitchValue = document.getElementById('speech-pitch-value');
        const mathReadingMode = document.getElementById('math-reading-mode');

        // Initialize speech synthesis
        const synth = window.speechSynthesis;
        let utterance = null;

        // Populate voice selector with available voices
        function populateVoiceList() {
            const voices = synth.getVoices();
            voiceSelector.innerHTML = '';

            voices.forEach(voice => {
                const option = document.createElement('option');
                option.textContent = `${voice.name} (${voice.lang})`;
                option.value = voice.name;
                voiceSelector.appendChild(option);
            });

            // Set default voice (first English voice or just first voice)
            const defaultVoice = voices.find(voice => voice.lang.includes('en')) || voices[0];
            if (defaultVoice) {
                voiceSelector.value = defaultVoice.name;
            }
        }

        // Chrome loads voices asynchronously
        if (synth.onvoiceschanged !== undefined) {
            synth.onvoiceschanged = populateVoiceList;
        }

        // Initial population attempt
        populateVoiceList();

        // Update rate and pitch value displays
        speechRate.addEventListener('input', function () {
            speechRateValue.textContent = this.value;
        });

        speechPitch.addEventListener('input', function () {
            speechPitchValue.textContent = this.value;
        });

        // Voice settings toggle
        document.getElementById('toggle-voice-settings').addEventListener('click', function () {
            document.getElementById('voice-settings').classList.add('hidden');
            document.getElementById('toggle-voice-settings-closed').classList.remove('hidden');
        });

        document.getElementById('toggle-voice-settings-closed').addEventListener('click', function () {
            document.getElementById('voice-settings').classList.remove('hidden');
            this.classList.add('hidden');
        });

        // Process mathematical text for speech
        function processMathForSpeech(text) {
            const mode = mathReadingMode.value;

            if (mode === 'skip') {
                // Remove all LaTeX math expressions
                return text.replace(/\$\$(.*?)\$\$/g, 'math equation').replace(/\$(.*?)\$/g, 'math symbol');
            } else if (mode === 'simple') {
                // Replace with simplified descriptions
                let processed = text;
                // Handle display math
                processed = processed.replace(/\$\$(.*?)\$\$/g, (match, p1) => {
                    return ' equation: ' + simplifyMathExpression(p1) + ' end of equation ';
                });
                // Handle inline math
                processed = processed.replace(/\$(.*?)\$/g, (match, p1) => {
                    return ' ' + simplifyMathExpression(p1) + ' ';
                });
                return processed;
            } else {
                // Detailed reading (default)
                let processed = text;
                // Handle display math
                processed = processed.replace(/\$\$(.*?)\$\$/g, (match, p1) => {
                    return ' equation: ' + readMathExpression(p1) + ' end of equation ';
                });
                // Handle inline math
                processed = processed.replace(/\$(.*?)\$/g, (match, p1) => {
                    return ' ' + readMathExpression(p1) + ' ';
                });
                return processed;
            }
        }

        function simplifyMathExpression(mathText) {
            // Basic simplification for common LaTeX expressions
            let simplified = mathText
                .replace(/\\frac{(.*?)}{(.*?)}/g, '$1 divided by $2')
                .replace(/\\sqrt{(.*?)}/g, 'square root of $1')
                .replace(/\\sum/g, 'sum')
                .replace(/\\int/g, 'integral')
                .replace(/\\infty/g, 'infinity')
                .replace(/\^{(.*?)}/g, ' to the power of $1')
                .replace(/\^(\d)/g, ' to the power of $1')
                .replace(/_{(.*?)}/g, ' subscript $1')
                .replace(/_(\d)/g, ' subscript $1')
                .replace(/\\pi/g, 'pi')
                .replace(/\\theta/g, 'theta')
                .replace(/\\alpha/g, 'alpha');

            return simplified;
        }

        function readMathExpression(mathText) {
            // More detailed reading of LaTeX
            let detailed = mathText
                .replace(/\\frac{(.*?)}{(.*?)}/g, 'the fraction with numerator $1 and denominator $2')
                .replace(/\\sqrt{(.*?)}/g, 'the square root of $1')
                .replace(/\\sum_{(.*?)}^{(.*?)}/g, 'the sum from $1 to $2 of')
                .replace(/\\int_{(.*?)}^{(.*?)}/g, 'the integral from $1 to $2 of')
                .replace(/\\infty/g, 'infinity')
                .replace(/\^{(.*?)}/g, ' raised to the power of $1')
                .replace(/\^(\d)/g, ' raised to the power of $1')
                .replace(/_{(.*?)}/g, ' subscript $1')
                .replace(/_(\d)/g, ' subscript $1')
                .replace(/\\pi/g, 'pi')
                .replace(/\\theta/g, 'theta')
                .replace(/\\alpha/g, 'alpha')
                .replace(/\\beta/g, 'beta')
                .replace(/\\gamma/g, 'gamma')
                .replace(/\\delta/g, 'delta')
                .replace(/\\epsilon/g, 'epsilon')
                .replace(/\\left\(/g, 'open parenthesis')
                .replace(/\\right\)/g, 'close parenthesis')
                .replace(/\\left\[/g, 'open bracket')
                .replace(/\\right\]/g, 'close bracket');

            return detailed;
        }

        // Read note function
        readNoteBtn.addEventListener('click', function () {
            const content = noteContent.value;

            if (!content.trim()) {
                showToast('error', 'Empty Note', 'Please enter some text to read aloud.');
                return;
            }

            // If already speaking, stop current speech
            if (synth.speaking) {
                synth.cancel();
            }

            // Process the text to handle math expressions
            const processedText = processMathForSpeech(content);

            // Create new utterance
            utterance = new SpeechSynthesisUtterance(processedText);

            // Set voice, rate, and pitch
            const voices = synth.getVoices();
            const selectedVoice = voices.find(voice => voice.name === voiceSelector.value);
            if (selectedVoice) utterance.voice = selectedVoice;

            utterance.rate = parseFloat(speechRate.value);
            utterance.pitch = parseFloat(speechPitch.value);

            // Set event handlers
            utterance.onstart = function () {
                readNoteBtn.disabled = true;
                pauseNoteBtn.disabled = false;
                stopNoteBtn.disabled = false;
                showToast('info', 'Reading Started', 'Your note is being read aloud.');
            };

            utterance.onend = function () {
                readNoteBtn.disabled = false;
                pauseNoteBtn.disabled = true;
                stopNoteBtn.disabled = true;
            };

            utterance.onerror = function (event) {
                console.error('SpeechSynthesis Error:', event);
                readNoteBtn.disabled = false;
                pauseNoteBtn.disabled = true;
                stopNoteBtn.disabled = true;
                showToast('error', 'Reading Error', 'There was a problem reading your note.');
            };

            // Start speaking
            synth.speak(utterance);
        });

        // Pause/resume
        pauseNoteBtn.addEventListener('click', function () {
            if (!synth.speaking) return;

            if (synth.paused) {
                synth.resume();
                this.innerHTML = '<i class="ri-pause-line"></i>';
                showToast('info', 'Reading Resumed', 'Reading has been resumed.');
            } else {
                synth.pause();
                this.innerHTML = '<i class="ri-play-line"></i>';
                showToast('info', 'Reading Paused', 'Reading has been paused.');
            }
        });

        // Stop
        stopNoteBtn.addEventListener('click', function () {
            if (synth.speaking) {
                synth.cancel();
                readNoteBtn.disabled = false;
                pauseNoteBtn.disabled = true;
                stopNoteBtn.disabled = true;
                pauseNoteBtn.innerHTML = '<i class="ri-pause-line"></i>';
                showToast('info', 'Reading Stopped', 'Reading has been stopped.');
            }
        });

        // Math preview
        const previewMathBtn = document.getElementById('preview-math-btn');
        const mathPreviewPanel = document.getElementById('math-preview-panel');
        const mathPreviewContent = document.getElementById('math-preview-content');
        const closePreviewBtn = document.getElementById('close-preview');

        previewMathBtn.addEventListener('click', function () {
            const content = noteContent.value;

            if (!content.trim()) {
                showToast('error', 'Empty Note', 'Please enter content with math formulas to preview.');
                return;
            }

            // Extract and display all math formulas
            const displayMathRegex = /\$\$(.*?)\$\$/g;
            const inlineMathRegex = /\$(.*?)\$/g;

            let displayMatches = [...content.matchAll(displayMathRegex)];
            let inlineMatches = [...content.matchAll(inlineMathRegex)];

            if (displayMatches.length === 0 && inlineMatches.length === 0) {
                showToast('info', 'No Math Found', 'No math formulas found. Use $ for inline math or $$ for display math.');
                return;
            }

            // Generate preview HTML
            let previewHTML = '<div class="space-y-4">';

            if (displayMatches.length > 0) {
                previewHTML += '<h4 class="font-medium">Display Math</h4>';
                displayMatches.forEach((match, index) => {
                    previewHTML += `<div class="p-2 border border-gray-200 dark:border-gray-600 rounded">$${match[1]}$</div>`;
                });
            }

            if (inlineMatches.length > 0) {
                previewHTML += '<h4 class="font-medium mt-4">Inline Math</h4>';
                inlineMatches.forEach((match, index) => {
                    previewHTML += `<div class="p-2 border border-gray-200 dark:border-gray-600 rounded">$${match[1]}$</div>`;
                });
            }

            previewHTML += '</div>';

            // Update preview panel
            mathPreviewContent.innerHTML = previewHTML;
            mathPreviewPanel.classList.remove('hidden');

            // Render math
            MathJax.typeset([mathPreviewContent]);
        });

        closePreviewBtn.addEventListener('click', function () {
            mathPreviewPanel.classList.add('hidden');
        });

        // Note formatting buttons
        document.getElementById('format-bold').addEventListener('click', function () {
            insertFormatting('**', '**');
        });

        document.getElementById('format-italic').addEventListener('click', function () {
            insertFormatting('*', '*');
        });

        document.getElementById('format-underline').addEventListener('click', function () {
            insertFormatting('<u>', '</u>');
        });

        document.getElementById('format-math').addEventListener('click', function () {
            insertFormatting('$$', '$$');
        });

        function insertFormatting(startTag, endTag) {
            const textarea = document.getElementById('note-content');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const text = textarea.value;
            const selectedText = text.substring(start, end);

            // Insert the formatting tags around the selected text
            const newText = text.substring(0, start) + startTag + selectedText + endTag + text.substring(end);
            textarea.value = newText;

            // Set the cursor position after the inserted text
            textarea.focus();
            textarea.selectionStart = start + startTag.length + selectedText.length + endTag.length;
            textarea.selectionEnd = textarea.selectionStart;
        }

        // File upload for notes
        const fileDropZone = document.getElementById('file-drop-zone');
        const fileUpload = document.getElementById('file-upload');
        const browseFilesBtn = document.getElementById('browse-files-btn');
        const uploadProgress = document.getElementById('upload-progress');
        const uploadProgressBar = document.getElementById('upload-progress-bar');
        const uploadPercentage = document.getElementById('upload-percentage');
        const fileName = document.getElementById('file-name');

        browseFilesBtn.addEventListener('click', () => {
            fileUpload.click();
        });

        // Handle drag and drop events
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            fileDropZone.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            fileDropZone.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            fileDropZone.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
            fileDropZone.classList.add('active');
        }

        function unhighlight() {
            fileDropZone.classList.remove('active');
        }

        // Handle file drop
        fileDropZone.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }

        // Handle file input change
        fileUpload.addEventListener('change', function () {
            handleFiles(this.files);
        });

        function handleFiles(files) {
            if (files.length === 0) return;

            const file = files[0];
            fileName.textContent = file.name;
            uploadProgress.classList.remove('hidden');

            // Simulate upload progress
            let progress = 0;
            const interval = setInterval(() => {
                progress += 5;
                uploadProgressBar.style.width = `${progress}%`;
                uploadPercentage.textContent = `${progress}%`;

                if (progress >= 100) {
                    clearInterval(interval);
                    processFile(file);
                }
            }, 50);
        }

        function processFile(file) {
            const reader = new FileReader();

            reader.onload = function (e) {
                let content = e.target.result;

                // Basic processing based on file type
                if (file.name.endsWith('.txt') || file.name.endsWith('.md')) {
                    // Text files can be directly put into the textarea
                    noteContent.value = content;
                } else if (file.name.endsWith('.pdf') || file.name.endsWith('.docx')) {
                    // For PDF and DOCX, we'd normally use a specialized library
                    // But for this demo, we'll simulate extracted content
                    showToast('info', 'File Processed', `${file.name} has been processed. Content extracted.`);
                    noteContent.value = `Content extracted from ${file.name}:\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam auctor, nisl eget ultricies tincidunt, nisl nisl aliquam nisl, eget aliquam nisl nisl eget nisl.`;
                }

                // Hide progress after processing
                setTimeout(() => {
                    uploadProgress.classList.add('hidden');
                    showToast('success', 'File Uploaded', 'File has been uploaded and processed successfully.');
                }, 500);
            };

            reader.onerror = function () {
                uploadProgress.classList.add('hidden');
                showToast('error', 'File Error', 'An error occurred while reading the file.');
            };

            // Read the file as text
            if (file.type.match('text.*') || file.name.endsWith('.md')) {
                reader.readAsText(file);
            } else {
                // For non-text files, we'd use specific processing
                // This is simulated for the demo
                setTimeout(() => {
                    reader.onload({
                        target: {
                            result: `Simulated content from ${file.name}\n\nThis is placeholder text that would normally be extracted from the file using appropriate libraries.`
                        }
                    });
                }, 1000);
            }
        }

        // Generate Questions from Notes
        const generateQuestionsBtn = document.getElementById('generate-questions-btn');
        const questionsModal = document.getElementById('questions-modal');
        const questionsContainer = document.getElementById('questions-container');
        const closeQuestionsModalBtn = document.getElementById('close-questions-modal-btn');
        const saveQuestionsBtn = document.getElementById('save-questions-btn');

        generateQuestionsBtn.addEventListener('click', async function () {
            const content = noteContent.value;
            const title = document.getElementById('note-title').value;

            if (!content.trim()) {
                showToast('error', 'Empty Note', 'Please enter note content to generate questions.');
                return;
            }

            // Show the modal with loading state
            questionsModal.classList.remove('hidden');
            questionsContainer.innerHTML = `
                <div class="animate-pulse">
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"></div>
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6 mb-4"></div>
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"></div>
                    <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mb-4"></div>
                </div>
            `;

            // Register handler for the AI response
            window.Poe.registerHandler("questions-handler", (result) => {
                const response = result.responses[0];

                if (response.status === "error") {
                    questionsContainer.innerHTML = `<p class="text-red-500">Error: ${response.statusText || "Failed to generate questions"}</p>`;
                } else if (response.status === "incomplete") {
                    // Update with streaming content
                    questionsContainer.innerHTML = marked.parse(response.content);
                    // Render math if present
                    if (response.content.includes('$')) {
                        MathJax.typeset([questionsContainer]);
                    }
                } else if (response.status === "complete") {
                    // Update with final content
                    questionsContainer.innerHTML = marked.parse(response.content);
                    // Render math if present
                    if (response.content.includes('$')) {
                        MathJax.typeset([questionsContainer]);
                    }
                }
            });

            try {
                // Format the prompt for question generation
                let prompt = `@Claude-3.5-Haiku Based on the following notes, generate 5-10 quiz questions that would help test understanding of this material. Include a mix of multiple choice, true/false, and short answer questions. For each question, provide the answer as well.

If the notes include mathematical content, please use LaTeX notation with $ symbols for the questions and answers.

Notes title: ${title || 'Untitled Note'}
Notes content:
${content}

Format your response as markdown with clear headings for each question and answer. Number each question.`;

                // Send the message to Claude
                await window.Poe.sendUserMessage(prompt, {
                    handler: "questions-handler",
                    stream: true,
                    openChat: false
                });
            } catch (error) {
                questionsContainer.innerHTML = `<p class="text-red-500">Error: ${error.message || "Failed to generate questions"}</p>`;
            }
        });

        closeQuestionsModalBtn.addEventListener('click', function () {
            questionsModal.classList.add('hidden');
        });

        saveQuestionsBtn.addEventListener('click', function () {
            showToast('success', 'Questions Saved', 'Study questions have been saved.');
            questionsModal.classList.add('hidden');
        });

        // Note saving and management
        const saveNoteBtn = document.getElementById('save-note-btn');
        const clearNoteBtn = document.getElementById('clear-note-btn');
        const notesList = document.getElementById('notes-list');

        saveNoteBtn.addEventListener('click', function () {
            const title = document.getElementById('note-title').value;
            const content = noteContent.value;

            if (!title.trim() || !content.trim()) {
                showToast('error', 'Missing Information', 'Please enter both a title and content for your note.');
                return;
            }

            // In a real app, we'd save this to a database
            // For this demo, we'll add it to the list UI

            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

            // Determine the type of note (plain text or math)
            const hasMath = content.includes('$');

            const noteElement = document.createElement('div');
            noteElement.className = 'p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer';
            noteElement.innerHTML = `
                <div class="flex justify-between">
                    <p class="font-medium">${title}</p>
                    <span class="text-xs bg-${hasMath ? 'purple' : 'green'}-100 text-${hasMath ? 'purple' : 'green'}-800 dark:bg-${hasMath ? 'purple' : 'green'}-900 dark:text-${hasMath ? 'purple' : 'green'}-300 px-1.5 py-0.5 rounded">${hasMath ? 'Math' : 'Text'}</span>
                </div>
                <p class="text-xs text-gray-500 dark:text-gray-400">Today, ${timeString}</p>
            `;

            // Add click event to load this note
            noteElement.addEventListener('click', function () {
                document.getElementById('note-title').value = title;
                noteContent.value = content;
            });

            // Add the note to the top of the list
            notesList.insertBefore(noteElement, notesList.firstChild);

            showToast('success', 'Note Saved', 'Your note has been saved successfully!');
        });

        clearNoteBtn.addEventListener('click', function () {
            document.getElementById('note-title').value = '';
            noteContent.value = '';
            showToast('info', 'Note Cleared', 'Note content has been cleared.');
        });

        // Export functionality
        document.getElementById('export-txt-btn').addEventListener('click', function () {
            const title = document.getElementById('note-title').value || 'Untitled';
            const content = noteContent.value;

            if (!content.trim()) {
                showToast('error', 'Empty Note', 'Please enter some content to export.');
                return;
            }

            // Create a downloadable element
            const link = document.createElement('a');

            // Create and append text content
            const textBlob = new Blob([content], { type: 'text/plain' });
            const textURL = URL.createObjectURL(textBlob);

            // Instead of triggering download, we'll show as text
            showToast('success', 'Text Export Ready', 'Right-click the link and select "Save link as" to download.');
            window.open(textURL, '_blank');
        });

        document.getElementById('export-md-btn').addEventListener('click', function () {
            const title = document.getElementById('note-title').value || 'Untitled';
            const content = noteContent.value;

            if (!content.trim()) {
                showToast('error', 'Empty Note', 'Please enter some content to export.');
                return;
            }

            // Create markdown content
            let markdown = `# ${title}\n\n${content}`;

            // Create and append markdown content
            const mdBlob = new Blob([markdown], { type: 'text/markdown' });
            const mdURL = URL.createObjectURL(mdBlob);

            // Instead of triggering download, we'll show as text
            showToast('success', 'Markdown Export Ready', 'Right-click the link and select "Save link as" to download.');
            window.open(mdURL, '_blank');
        });

        document.getElementById('export-pdf-btn').addEventListener('click', function () {
            showToast('info', 'PDF Export', 'PDF export would normally convert your note to a downloadable PDF file.');
        });

        // ibicu AI Chat functionality
        const chatInput = document.getElementById('chat-input');
        const chatSendBtn = document.getElementById('chat-send-btn');
        const chatMessages = document.getElementById('chat-messages');
        const newChatBtn = document.getElementById('new-chat-btn');
        const clearChatBtn = document.getElementById('clear-chat-btn');

        chatSendBtn.addEventListener('click', async function () {
            const message = chatInput.value.trim();

            if (!message) {
                showToast('error', 'Empty Message', 'Please enter a message to send.');
                return;
            }

            // Add user message to chat
            addMessage('user', message);

            // Clear input
            chatInput.value = '';

            // Add loading indicator
            const loadingBubble = document.createElement('div');
            loadingBubble.className = 'flex items-start loading-bubble';
            loadingBubble.innerHTML = `
                <div class="h-8 w-8 rounded-full bg-primary text-white flex items-center justify-center mt-1 mr-2">
                    <i class="ri-robot-line"></i>
                </div>
                <div class="chat-bubble-ai bg-gray-100 dark:bg-gray-700 p-3 max-w-[80%]">
                    <div class="flex space-x-2">
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(loadingBubble);
            chatMessages.scrollTop = chatMessages.scrollHeight;

            // Register handler for the AI response
            window.Poe.registerHandler("chat-handler", (result) => {
                const response = result.responses[0];

                // Remove loading indicator once we get any response
                const loadingElement = document.querySelector('.loading-bubble');
                if (loadingElement) loadingElement.remove();

                if (response.status === "error") {
                    addMessage('ai', `I'm sorry, there was an error processing your request. Please try again later.`);
                } else if (response.status === "incomplete") {
                    // For streaming responses, update the existing message or create a new one
                    updateOrCreateAIMessage(response.content);
                } else if (response.status === "complete") {
                    // Make sure we have the final message
                    updateOrCreateAIMessage(response.content);
                }
            });

            try {
                // Send message to Claude
                await window.Poe.sendUserMessage(`@Claude-3.5-Haiku You're an AI tutor representing Cloud Haiku AI. Your name is ibicu AI. Please reply to the following: ${message}`, {
                    handler: "chat-handler",
                    stream: true,
                    openChat: false
                });
            } catch (error) {
                // Remove loading indicator
                const loadingElement = document.querySelector('.loading-bubble');
                if (loadingElement) loadingElement.remove();

                // Add error message
                addMessage('ai', `I'm sorry, there was an error sending your message. Please try again later.`);
                console.error('Error sending message:', error);
            }
        });

        // Add a message to the chat
        function addMessage(sender, content) {
            const messageDiv = document.createElement('div');

            if (sender === 'user') {
                messageDiv.className = 'flex justify-end';
                messageDiv.innerHTML = `
                    <div class="chat-bubble-user bg-primary text-white p-3 max-w-[80%]">
                        <p>${content}</p>
                    </div>
                `;
            } else {
                messageDiv.className = 'flex items-start ai-message';
                messageDiv.innerHTML = `
                    <div class="h-8 w-8 rounded-full bg-primary text-white flex items-center justify-center mt-1 mr-2">
                        <i class="ri-robot-line"></i>
                    </div>
                    <div class="chat-bubble-ai bg-gray-100 dark:bg-gray-700 p-3 max-w-[80%]">
                        ${marked.parse(content)}
                    </div>
                `;

                // Render math if present
                if (content.includes('$')) {
                    setTimeout(() => {
                        MathJax.typeset([messageDiv.querySelector('.chat-bubble-ai')]);
                    }, 100);
                }
            }

            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Update existing AI message or create a new one
        function updateOrCreateAIMessage(content) {
            // Check if we already have an AI message that we can update
            const aiMessage = document.querySelector('.ai-message:last-child');

            if (aiMessage && aiMessage === chatMessages.lastElementChild) {
                // Update existing message
                const bubble = aiMessage.querySelector('.chat-bubble-ai');
                bubble.innerHTML = marked.parse(content);

                // Render math if present
                if (content.includes('$')) {
                    MathJax.typeset([bubble]);
                }
            } else {
                // Create new message
                addMessage('ai', content);
            }

            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Handle Enter key in chat input
        chatInput.addEventListener('keydown', function (e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                chatSendBtn.click();
            }
        });

        // New chat button
        newChatBtn.addEventListener('click', function () {
            clearChat();

            // Add welcome message
            addMessage('ai', '👋 Hi there! I\'m ibicu AI, your personal study assistant powered by Cloud Haiku AI. How can I help you with your studies today?');

            showToast('info', 'New Chat', 'Started a new conversation.');
        });

        // Clear chat button
        clearChatBtn.addEventListener('click', function () {
            clearChat();
            showToast('info', 'Chat Cleared', 'The conversation has been cleared.');
        });

        function clearChat() {
            // Remove all messages except the first (welcome message)
            while (chatMessages.children.length > 1) {
                chatMessages.removeChild(chatMessages.lastChild);
            }
        }

        // Coming soon alerts
        document.getElementById('new-challenge-btn').addEventListener('click', function () {
            showToast('info', 'Coming Soon', 'New productivity challenges will be available soon!');
        });

        // Update timer display on page load
        updateTimerDisplay();

        // Admin Portal Login Functionality
        const adminLoginBtn = document.getElementById('admin-login-btn');
        const adminLoginModal = document.getElementById('admin-login-modal');
        const adminLoginForm = document.getElementById('admin-login-form');
        const adminLoginSubmitBtn = document.getElementById('admin-login-submit-btn');
        const adminLoginCancelBtn = document.getElementById('admin-login-cancel-btn');
        const adminLoginError = document.getElementById('admin-login-error');
        const adminLogoutBtn = document.getElementById('admin-logout-btn');
        const adminTabBtn = document.getElementById('admin-tab-btn');

        adminLoginBtn.addEventListener('click', function () {
            adminLoginModal.classList.remove('hidden');
            adminLoginError.classList.add('hidden');
            document.getElementById('admin-username').value = '';
            document.getElementById('admin-password').value = '';
        });

        adminLoginCancelBtn.addEventListener('click', function () {
            adminLoginModal.classList.add('hidden');
        });

        adminLoginSubmitBtn.addEventListener('click', function () {
            const username = document.getElementById('admin-username').value;
            const password = document.getElementById('admin-password').value;

            if (username === 'admin' && password === 'password') {
                adminLoginModal.classList.add('hidden');
                adminTabBtn.classList.remove('hidden');
                showToast('success', 'Login Successful', 'Welcome to the admin portal.');

                // Automatically navigate to admin tab
                document.querySelector('.tab-button[data-tab="admin"]').click();
            } else {
                adminLoginError.classList.remove('hidden');
            }
        });

        adminLogoutBtn.addEventListener('click', function () {
            adminTabBtn.classList.add('hidden');
            document.querySelector('.tab-button[data-tab="dashboard"]').click();
            showToast('info', 'Logged Out', 'You have been logged out of the admin portal.');
        });

        // Admin Tab Navigation
        const adminTabBtns = document.querySelectorAll('.admin-tab-btn');
        const adminTabContents = document.querySelectorAll('.admin-tab-content');

        adminTabBtns.forEach(button => {
            button.addEventListener('click', function () {
                const tab = this.dataset.tab;

                // Remove active class from all buttons and contents
                adminTabBtns.forEach(btn => {
                    btn.classList.remove('border-primary', 'text-primary');
                    btn.classList.add('border-transparent', 'text-gray-500', 'dark:text-gray-400');
                });

                adminTabContents.forEach(content => {
                    content.classList.add('hidden');
                });

                // Add active class to selected button and content
                this.classList.add('border-primary', 'text-primary');
                this.classList.remove('border-transparent', 'text-gray-500', 'dark:text-gray-400');
                document.getElementById(`admin-${tab}`).classList.remove('hidden');
            });
        });

        // Admin Content Management
        const addContentBtn = document.getElementById('add-content-btn');
        const addContentForm = document.getElementById('add-content-form');
        const pastpaperForm = document.getElementById('pastpaper-form');
        const musicForm = document.getElementById('music-form');
        const contentType = document.getElementById('content-type');
        const cancelAddContent = document.getElementById('cancel-add-content');
        const saveNewContent = document.getElementById('save-new-content');

        // Show/hide content forms based on selected content type
        contentType.addEventListener('change', function () {
            const selectedType = this.value;

            // Hide all forms first
            pastpaperForm.classList.add('hidden');
            musicForm.classList.add('hidden');

            // Show the selected form
            if (selectedType === 'pastpapers') {
                pastpaperForm.classList.remove('hidden');
            } else if (selectedType === 'music') {
                musicForm.classList.remove('hidden');
            }
        });

        // Add content button click
        addContentBtn.addEventListener('click', function () {
            addContentForm.classList.remove('hidden');

            // Default to showing the past papers form
            pastpaperForm.classList.remove('hidden');
            musicForm.classList.add('hidden');
            contentType.value = 'pastpapers';
        });

        // Cancel add content
        cancelAddContent.addEventListener('click', function () {
            addContentForm.classList.add('hidden');
            // Clear all form fields
            document.getElementById('paper-title').value = '';
            document.getElementById('paper-subject-input').value = 'math';
            document.getElementById('paper-level-input').value = 'highschool';
            document.getElementById('paper-year-input').value = '2023';
            document.getElementById('paper-board-input').value = 'aqa';
            document.getElementById('paper-file').value = '';
            document.getElementById('markscheme-file').value = '';

            document.getElementById('music-title').value = '';
            document.getElementById('music-url-admin').value = '';
            document.getElementById('music-category').value = 'lofi';
        });

        // Save new content
        saveNewContent.addEventListener('click', function () {
            const contentTypeValue = contentType.value;

            if (contentTypeValue === 'pastpapers') {
                const title = document.getElementById('paper-title').value;
                const subject = document.getElementById('paper-subject-input').value;
                const level = document.getElementById('paper-level-input').value;
                const year = document.getElementById('paper-year-input').value;
                const board = document.getElementById('paper-board-input').value;
                const paperFile = document.getElementById('paper-file').files[0];
                const markschemeFile = document.getElementById('markscheme-file').files[0];

                if (!title || !subject || !level || !year || !board || !paperFile) {
                    showToast('error', 'Missing Information', 'Please fill all required fields for past papers.');
                    return;
                }

                // Simulate file upload and processing
                showToast('info', 'Uploading', 'Processing and uploading your files...');

                setTimeout(() => {
                    addContentForm.classList.add('hidden');
                    showToast('success', 'Upload Complete', 'Past paper has been added successfully.');
                }, 2000);
            } else if (contentTypeValue === 'music') {
                const title = document.getElementById('music-title').value;
                const url = document.getElementById('music-url-admin').value;
                const category = document.getElementById('music-category').value;

                if (!title || !url || !category) {
                    showToast('error', 'Missing Information', 'Please fill all required fields for study music.');
                    return;
                }

                // Simulate adding music
                showToast('info', 'Adding Music', 'Processing and adding your music...');

                setTimeout(() => {
                    addContentForm.classList.add('hidden');
                    showToast('success', 'Music Added', 'Study music has been added successfully.');
                }, 1500);
            }
        });

        // Email Notification Modal Functionality
        const emailNotificationModal = document.getElementById('email-notification-modal');
        const notificationSaveBtn = document.getElementById('notification-save-btn');
        const notificationCancelBtn = document.getElementById('notification-cancel-btn');
        const notificationEmail = document.getElementById('notification-email');

        function showEmailNotificationModal(context) {
            // Set default email if available
            notificationEmail.value = '';
            emailNotificationModal.classList.remove('hidden');
        }

        notificationSaveBtn.addEventListener('click', function () {
            const email = notificationEmail.value.trim();

            if (!email || !validateEmail(email)) {
                showToast('error', 'Invalid Email', 'Please enter a valid email address.');
                return;
            }

            // Simulate saving email preferences
            showToast('success', 'Preferences Saved', 'Your email notification preferences have been saved.');
            emailNotificationModal.classList.add('hidden');
        });

        notificationCancelBtn.addEventListener('click', function () {
            emailNotificationModal.classList.add('hidden');
        });

        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(String(email).toLowerCase());
        }

        // Dashboard Notification Button
        document.getElementById('dashboard-notifications-btn').addEventListener('click', function () {
            showEmailNotificationModal('Dashboard');
        });

        // Set Reminder Button
        document.querySelectorAll('#set-reminder-btn').forEach(button => {
            button.addEventListener('click', function () {
                const deadline = this.dataset.deadline;
                const date = this.dataset.date;

                showToast('info', 'Reminder Set', `Reminder set for ${deadline} (${date}).`);
            });
        });

        // Initialize with a daily quote and Bible verse
        generateDailyQuote();
        updateBibleVerse(bibleVerseText, bibleVerseReference);
    </script>
</body>

</html>